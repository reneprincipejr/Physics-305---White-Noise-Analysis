\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Principe - Physics 305 Final Project}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \section{Physics 305 Final Project}\label{physics-305-final-project}

    \begin{itemize}
\tightlist
\item
  Rene L. Principe Jr.
\item
  2015-04622
\end{itemize}

    \subsection{Importing Libraries}\label{importing-libraries}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{tqdm} \PY{k+kn}{import} \PY{n}{tqdm}
\PY{k+kn}{import} \PY{n+nn}{itertools}
\PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
\PY{k+kn}{import} \PY{n+nn}{warnings}
\PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k+kn}{import} \PY{n}{gridspec}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{dates} \PY{k}{as} \PY{n+nn}{mdates}
\PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{dates} \PY{k+kn}{import} \PY{n}{DateFormatter}
\PY{k+kn}{import} \PY{n+nn}{datetime}

\PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k+kn}{import} \PY{n}{norm}\PY{p}{,} \PY{n}{describe}
\PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{optimize} \PY{k+kn}{import} \PY{n}{curve\PYZus{}fit}

\PY{k+kn}{import} \PY{n+nn}{math}
\PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{special} \PY{k+kn}{import} \PY{n}{gamma}\PY{p}{,} \PY{n}{jv}

\PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\end{Verbatim}
\end{tcolorbox}

    \subsection{Functions}\label{functions}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}sample\PYZus{}dx}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{delta}\PY{p}{)}\PY{p}{:}
    \PY{n}{x\PYZus{}trunc} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{delta}\PY{p}{]}
    \PY{n}{x\PYZus{}shift} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{n}{delta}\PY{p}{:}\PY{p}{]}
    \PY{n}{dx} \PY{o}{=} \PY{n}{x\PYZus{}shift} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}trunc}
    \PY{k}{return} \PY{n}{dx}

\PY{k}{def} \PY{n+nf}{get\PYZus{}pdf}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{delta}\PY{p}{,} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{norm}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
    \PY{n}{dx} \PY{o}{=} \PY{n}{get\PYZus{}sample\PYZus{}dx}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{delta}\PY{p}{)}
    \PY{n}{pdf}\PY{p}{,} \PY{n}{junk} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{histogram}\PY{p}{(}\PY{n}{dx}\PY{p}{,} \PY{n}{bins} \PY{o}{=} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{density}\PY{o}{=}\PY{n}{norm}\PY{p}{)}
    \PY{k}{return} \PY{n}{pdf}

\PY{k}{def} \PY{n+nf}{gaussian}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{sigma2}\PY{p}{,} \PY{n}{N}\PY{p}{)}\PY{p}{:}
    \PY{n}{fac} \PY{o}{=} \PY{n}{N}\PY{o}{/}\PY{p}{(}\PY{l+m+mf}{2.}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{n}{sigma2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}
    \PY{k}{return} \PY{n}{fac}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.}\PY{o}{*}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{/}\PY{l+m+mf}{2.}\PY{o}{/}\PY{n}{sigma2}\PY{p}{)}

\PY{c+c1}{\PYZsh{} define function that performs fit}
\PY{k}{def} \PY{n+nf}{fit\PYZus{}pdf}\PY{p}{(}\PY{n}{bin\PYZus{}centers}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{yerr}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{initial}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{1.}\PY{p}{,} \PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{,} \PY{n}{maxfev}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}\PY{p}{:}
    \PY{k}{if}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{yerr}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{} no uncertainties given}
        \PY{n}{popt}\PY{p}{,} \PY{n}{pcov} \PY{o}{=} \PY{n}{curve\PYZus{}fit}\PY{p}{(}\PY{n}{gaussian}\PY{p}{,} \PY{n}{bin\PYZus{}centers}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{initial}\PY{p}{,} \PY{n}{maxfev}\PY{o}{=}\PY{n}{maxfev}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{popt}\PY{p}{,} \PY{n}{pcov} \PY{o}{=} \PY{n}{curve\PYZus{}fit}\PY{p}{(}\PY{n}{gaussian}\PY{p}{,} \PY{n}{bin\PYZus{}centers}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{initial}\PY{p}{,} \PY{n}{sigma}\PY{o}{=}\PY{n}{yerr}\PY{p}{,} \PY{n}{maxfev}\PY{o}{=}\PY{n}{maxfev}\PY{p}{)}
    \PY{n}{sigma2}\PY{p}{,} \PY{n}{N} \PY{o}{=} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{err\PYZus{}sigma2}\PY{p}{,} \PY{n}{err\PYZus{}N} \PY{o}{=} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}
    \PY{k}{return} \PY{n}{sigma2}\PY{p}{,} \PY{n}{err\PYZus{}sigma2}\PY{p}{,} \PY{n}{N}\PY{p}{,} \PY{n}{err\PYZus{}N}
\end{Verbatim}
\end{tcolorbox}

    \section{Application on Black Marble NTL
dataset}\label{application-on-black-marble-ntl-dataset}

    \subsubsection{Loading extracted NTL
data}\label{loading-extracted-ntl-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{data\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../Project/data/VNP46A2\PYZus{}Regional/NCR\PYZus{}NTL\PYZus{}VNP46A2.csv}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{Read saved CSV file}\label{read-saved-csv-file}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{data\PYZus{}path}\PY{p}{,} \PY{n}{parse\PYZus{}dates}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{index\PYZus{}col} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            DNB\_BRDF\_Corrected\_NTL  DNB\_Lunar\_Irradiance  \textbackslash{}
date
2012-01-19               21.733953                   0.5
2012-01-20               28.488267                   0.5
2012-01-21               19.911453                   0.5
2012-01-22               18.401624                   0.5
2012-01-23               18.080945                   0.5

            Gap\_Filled\_DNB\_BRDF\_Corrected\_NTL  Latest\_High\_Quality\_Retrieval  \textbackslash{}
date
2012-01-19                          21.923586                       0.033966
2012-01-20                          27.802954                       0.049842
2012-01-21                          21.199934                       0.216042
2012-01-22                          18.264756                       0.016959
2012-01-23                          17.632629                       0.306467

            Mandatory\_Quality\_Flag  QF\_Cloud\_Mask  Snow\_Flag
date
2012-01-19                0.014491      18.793525        0.0
2012-01-20                0.079840      37.635675        0.0
2012-01-21                0.014784      65.977834        0.0
2012-01-22                0.006436      47.463276        0.0
2012-01-23                0.439113      55.778030        0.0
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{data}\PY{o}{.}\PY{n}{index}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DatetimeIndex(['2012-01-19', '2012-01-20', '2012-01-21', '2012-01-22',
               '2012-01-23', '2012-01-24', '2012-01-25', '2012-01-26',
               '2012-01-27', '2012-01-28',
               {\ldots}
               '2023-06-02', '2023-06-03', '2023-06-04', '2023-06-05',
               '2023-06-06', '2023-06-07', '2023-06-08', '2023-06-09',
               '2023-06-10', '2023-06-11'],
              dtype='datetime64[ns]', name='date', length=4142, freq=None)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{n\PYZus{}init} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Size of original dataset: }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{n\PYZus{}init}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Size of original dataset: 4142
    \end{Verbatim}

    \subsubsection{Descriptive statistics}\label{descriptive-statistics}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{data}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
       DNB\_BRDF\_Corrected\_NTL  DNB\_Lunar\_Irradiance  \textbackslash{}
count             2670.000000           4107.000000
mean                22.044298             26.312285
std                  7.017390             36.803359
min                  0.032562              0.500000
25\%                 18.622556              0.500000
50\%                 22.592008              0.500000
75\%                 26.418989             44.950000
max                 73.589233            164.198530

       Gap\_Filled\_DNB\_BRDF\_Corrected\_NTL  Latest\_High\_Quality\_Retrieval  \textbackslash{}
count                        4107.000000                    4107.000000
mean                           23.818935                       3.993595
std                             3.226065                       4.479393
min                             4.203769                       0.003160
25\%                            22.083439                       1.072860
50\%                            24.217076                       2.373474
75\%                            25.753041                       5.256165
max                            35.925257                      28.598642

       Mandatory\_Quality\_Flag  QF\_Cloud\_Mask    Snow\_Flag
count             2670.000000    4107.000000  4083.000000
mean                 0.447146     371.321069     0.000673
std                  0.698937     294.696914     0.012084
min                  0.000000       3.080248     0.000000
25\%                  0.013410      61.538253     0.000000
50\%                  0.049517     297.811024     0.000000
75\%                  0.600256     728.083553     0.000000
max                  2.000000     753.366582     0.369491
\end{Verbatim}
\end{tcolorbox}
        
    \subsection{Plotting the timeseries
data}\label{plotting-the-timeseries-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.4}\PY{p}{)}

\PY{n}{NTL} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{NTL\PYZus{}GF} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
         \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ observations)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}GF}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}
         \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL\PYZus{}GF}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ observations)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Radiance, \PYZdl{}nW·cm\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−2\PYZcb{}·sr\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−1\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{National Capital Region (NCR) VNP46A2 nighttime lights (NTL)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{gcf}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{autofmt\PYZus{}xdate}
\PY{n}{dtFmt} \PY{o}{=} \PY{n}{mdates}\PY{o}{.}\PY{n}{DateFormatter}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{b\PYZhy{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} define the formatting}
\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{xaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{dtFmt}\PY{p}{)} \PY{c+c1}{\PYZsh{} apply the format to the desired axis}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{view} \PY{o}{=} \PY{l+m+mi}{200}

\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.4}\PY{p}{)}

\PY{n}{NTL\PYZus{}} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{n}{view}\PY{p}{]}
\PY{n}{NTL\PYZus{}GF\PYZus{}} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{n}{view}\PY{p}{]}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bo\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{drawstyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{steps\PYZhy{}mid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
         \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL\PYZus{}}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ observations)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}GF\PYZus{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{drawstyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{steps\PYZhy{}mid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
         \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL\PYZus{}GF\PYZus{}}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ observations)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Radiance, \PYZdl{}nW·cm\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−2\PYZcb{}·sr\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−1\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{National Capital Region (NCR) VNP46A2 nighttime lights (NTL)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{gcf}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{autofmt\PYZus{}xdate}
\PY{n}{dtFmt} \PY{o}{=} \PY{n}{mdates}\PY{o}{.}\PY{n}{DateFormatter}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{b\PYZhy{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} define the formatting}
\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{xaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{dtFmt}\PY{p}{)} \PY{c+c1}{\PYZsh{} apply the format to the desired axis}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Missing datapoints}\label{missing-datapoints}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{date\PYZus{}range} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{date\PYZus{}range}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2012\PYZhy{}01\PYZhy{}19}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2023\PYZhy{}06\PYZhy{}12}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{NTL\PYZus{}reindexed} \PY{o}{=} \PY{n}{NTL}\PY{o}{.}\PY{n}{reindex}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{)}
\PY{n}{NTL\PYZus{}GF\PYZus{}reindexed} \PY{o}{=} \PY{n}{NTL\PYZus{}GF}\PY{o}{.}\PY{n}{reindex}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{)}

\PY{n}{NTL\PYZus{}missing\PYZus{}dates} \PY{o}{=} \PY{n}{NTL\PYZus{}reindexed}\PY{p}{[}\PY{n}{NTL\PYZus{}reindexed}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{NTL\PYZus{}GF\PYZus{}missing\PYZus{}dates} \PY{o}{=} \PY{n}{NTL\PYZus{}GF\PYZus{}reindexed}\PY{p}{[}\PY{n}{NTL\PYZus{}GF\PYZus{}reindexed}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{missing\PYZus{}days} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{NTL\PYZus{}GF}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
\PY{n}{cloud\PYZus{}contaminated} \PY{o}{=}  \PY{n}{NTL}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{missing\PYZus{}days}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of the }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ days, }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{missing\PYZus{}days}\PY{p}{)}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ observations are missing.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Meanwhile, }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{cloud\PYZus{}contaminated}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ days are cloud contaminated, hence, gap\PYZhy{}filled.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Of the 4163 days, 56 observations are missing.
Meanwhile, 2614 days are cloud contaminated, hence, gap-filled.
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.4}\PY{p}{)}


\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
         \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ observations)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}GF}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}
         \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL\PYZus{}GF}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ observations)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Radiance, \PYZdl{}nW·cm\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−2\PYZcb{}·sr\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−1\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{National Capital Region (NCR) VNP46A2 nighttime lights (NTL)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{gcf}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{autofmt\PYZus{}xdate}
\PY{n}{dtFmt} \PY{o}{=} \PY{n}{mdates}\PY{o}{.}\PY{n}{DateFormatter}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{b\PYZhy{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} define the formatting}
\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{xaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{dtFmt}\PY{p}{)} \PY{c+c1}{\PYZsh{} apply the format to the desired axis}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{NTL\PYZus{}GF\PYZus{}missing\PYZus{}dates}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{n+nb}{len}\PY{p}{(}\PY{n}{NTL\PYZus{}GF\PYZus{}missing\PYZus{}dates}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No sensor data record  (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{missing\PYZus{}days}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ instances)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{view} \PY{o}{=} \PY{l+m+mi}{200}

\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.4}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bo\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{drawstyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{steps\PYZhy{}mid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
         \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL\PYZus{}}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ observations)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}GF\PYZus{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{drawstyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{steps\PYZhy{}mid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
         \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL\PYZus{}GF\PYZus{}}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ observations)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Radiance, \PYZdl{}nW·cm\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−2\PYZcb{}·sr\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−1\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{National Capital Region (NCR) VNP46A2 nighttime lights (NTL)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{gcf}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{autofmt\PYZus{}xdate}
\PY{n}{dtFmt} \PY{o}{=} \PY{n}{mdates}\PY{o}{.}\PY{n}{DateFormatter}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{b\PYZhy{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} define the formatting}
\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{xaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{dtFmt}\PY{p}{)} \PY{c+c1}{\PYZsh{} apply the format to the desired axis}


\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{NTL\PYZus{}GF\PYZus{}missing\PYZus{}dates}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{n+nb}{len}\PY{p}{(}\PY{n}{NTL\PYZus{}GF\PYZus{}missing\PYZus{}dates}\PY{p}{[}\PY{p}{:}\PY{n}{view}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No sensor data record  (}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{missing\PYZus{}days}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ observations)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{date\PYZus{}range}\PY{p}{[}\PY{n}{view}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Generating PDFs}\label{generating-pdfs}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{data\PYZus{}sample} \PY{o}{=} \PY{n}{NTL\PYZus{}GF}
\PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    We select τ = 7 (weekly scale)

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tau} \PY{o}{=} \PY{l+m+mi}{7} \PY{c+c1}{\PYZsh{}7 days}
\PY{n}{dt} \PY{o}{=} \PY{l+m+mi}{1} \PY{c+c1}{\PYZsh{}1 day interval}

\PY{n}{delta} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{tau}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{tau: }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{, Delta: }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{tau}\PY{p}{,} \PY{n}{delta}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
tau: 7, Delta: 7
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{data\PYZus{}trunc} \PY{o}{=} \PY{n}{data\PYZus{}sample}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{delta}\PY{p}{]}
\PY{n}{data\PYZus{}shift} \PY{o}{=} \PY{n}{data\PYZus{}sample}\PY{p}{[}\PY{n}{delta}\PY{p}{:}\PY{p}{]}
\PY{n}{dx} \PY{o}{=} \PY{n}{data\PYZus{}shift}\PY{o}{.}\PY{n}{values} \PY{o}{\PYZhy{}} \PY{n}{data\PYZus{}trunc}\PY{o}{.}\PY{n}{values}
\PY{n+nb}{len}\PY{p}{(}\PY{n}{dx}\PY{p}{)}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data\PYZus{}trunc}\PY{p}{)}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data\PYZus{}shift}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(4135, 4135, 4135)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{data\PYZus{}trunc}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{data\PYZus{}shift}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(date
 2012-01-19    21.923586
 2012-01-20    27.802954
 2012-01-21    21.199934
 2012-01-22    18.264756
 2012-01-23    17.632629
 Name: Gap\_Filled\_DNB\_BRDF\_Corrected\_NTL, dtype: float64,
 date
 2012-01-26    21.449830
 2012-01-27          NaN
 2012-01-28    18.568147
 2012-01-29    17.997314
 2012-01-30    21.906167
 Name: Gap\_Filled\_DNB\_BRDF\_Corrected\_NTL, dtype: float64)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} view = 200}
\PY{c+c1}{\PYZsh{} plt.figure(dpi = 150, figsize = (15,3))}
\PY{c+c1}{\PYZsh{} plt.grid()}
\PY{c+c1}{\PYZsh{} plt.plot(data\PYZus{}trunc[:view].values, \PYZsq{}b.\PYZhy{}\PYZsq{}, alpha = 0.5, label = \PYZsq{}truncated NTL\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.plot(data\PYZus{}shift[:view].values, \PYZsq{}g.\PYZhy{}\PYZsq{}, alpha = 0.5, label = \PYZsq{}shifted NTL\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.plot(dx[:view\PYZhy{}tau], drawstyle = \PYZsq{}steps\PYZhy{}mid\PYZsq{}, color = \PYZsq{}red\PYZsq{}, label = \PYZsq{}displacements\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.legend()}
\PY{c+c1}{\PYZsh{} plt.show()}

\PY{c+c1}{\PYZsh{} plt.figure(dpi = 150, figsize = (15,3))}
\PY{c+c1}{\PYZsh{} plt.grid()}
\PY{c+c1}{\PYZsh{} plt.plot(data\PYZus{}trunc.values, \PYZsq{}b.\PYZhy{}\PYZsq{}, alpha = 0.5, ms = 1, lw = 0.5, label = \PYZsq{}truncated NTL\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.plot(data\PYZus{}shift.values, \PYZsq{}g.\PYZhy{}\PYZsq{}, alpha = 0.5, ms = 1, lw = 0.5, label = \PYZsq{}shifted NTL\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.plot(dx[:\PYZhy{}tau], drawstyle = \PYZsq{}steps\PYZhy{}mid\PYZsq{}, lw = 0.5, color = \PYZsq{}red\PYZsq{}, label = \PYZsq{}displacements\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.legend()}
\PY{c+c1}{\PYZsh{} plt.show()}
\end{Verbatim}
\end{tcolorbox}

    

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} \PYZsh{} Generate normal distribution}
\PY{c+c1}{\PYZsh{} xx\PYZus{}sd = np.sqrt(tau)}
\PY{c+c1}{\PYZsh{} xx = np.linspace(\PYZhy{}5, 5)*xx\PYZus{}sd \PYZsh{} gridded points from \PYZhy{}5 to 5 in units of sd}
\PY{c+c1}{\PYZsh{} xx\PYZus{}mean = 0.}
\PY{c+c1}{\PYZsh{} yy = norm.pdf(xx, xx\PYZus{}mean, xx\PYZus{}sd)}

\PY{c+c1}{\PYZsh{} plt.figure(figsize=(8,3), dpi = 150)}
\PY{c+c1}{\PYZsh{} plt.grid(alpha = 0.4)}
\PY{c+c1}{\PYZsh{} \PYZsh{} Plot PDF of displacements}
\PY{c+c1}{\PYZsh{} plt.hist(dx, density=True, bins=\PYZdq{}auto\PYZdq{}, label=\PYZdq{}NTL displacements histogram\PYZdq{}, color = \PYZsq{}red\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.xlabel(\PYZdq{}Delta x\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.ylabel(\PYZdq{}PDF\PYZdq{})}

\PY{c+c1}{\PYZsh{} \PYZsh{} \PYZsh{} Overlay normal distribution}
\PY{c+c1}{\PYZsh{} plt.plot(xx, yy, \PYZsq{}k\PYZhy{}\PYZsq{}, label=\PYZdq{}N(\PYZpc{}.1f,\PYZpc{}.2f)\PYZdq{} \PYZpc{} (xx\PYZus{}mean, xx\PYZus{}sd))}
\PY{c+c1}{\PYZsh{} plt.ylabel(\PYZdq{}PDF\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.xlabel(r\PYZdq{}\PYZdl{}\PYZbs{}Delta x\PYZdl{}\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.legend(loc=\PYZdq{}best\PYZdq{})}

\PY{c+c1}{\PYZsh{} plt.minorticks\PYZus{}on()}
\PY{c+c1}{\PYZsh{} plt.xlabel(r\PYZdq{}\PYZdl{}\PYZbs{}Delta x\PYZdl{}\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.ylabel(\PYZdq{}PDF\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.title(r\PYZdq{}Lag time: \PYZdl{}\PYZbs{}Delta=\PYZdl{}\PYZpc{}d days\PYZdq{} \PYZpc{} (tau))}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NTL\PYZus{}dx} \PY{o}{=} \PY{n}{get\PYZus{}sample\PYZus{}dx}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{n}{delta}\PY{p}{)}

\PY{n}{xlimit} \PY{o}{=} \PY{l+m+mf}{20.}
\PY{n}{n\PYZus{}bins} \PY{o}{=} \PY{l+m+mi}{50}
\PY{n}{bin\PYZus{}edges} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{xlimit}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.}\PY{p}{,} \PY{n}{xlimit}\PY{p}{,} \PY{n}{n\PYZus{}bins}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{pdf} \PY{o}{=} \PY{n}{get\PYZus{}pdf}\PY{p}{(}\PY{n}{NTL\PYZus{}dx}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{norm}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
              
\PY{n}{bin\PYZus{}centers} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{o}{*}\PY{p}{(}\PY{n}{bin\PYZus{}edges}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{bin\PYZus{}edges}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)}
\PY{n}{sigma2}\PY{p}{,} \PY{n}{err\PYZus{}sigma2}\PY{p}{,} \PY{n}{N}\PY{p}{,} \PY{n}{err\PYZus{}N} \PY{o}{=} \PY{n}{fit\PYZus{}pdf}\PY{p}{(}\PY{n}{bin\PYZus{}centers}\PY{p}{,} \PY{n}{pdf}\PY{p}{)}
\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{xlimit}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.}\PY{p}{,} \PY{n}{xlimit}\PY{p}{)}
\PY{n}{yy} \PY{o}{=} \PY{n}{gaussian}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{sigma2}\PY{p}{,} \PY{n}{N}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.4}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{stairs}\PY{p}{(}\PY{n}{pdf}\PY{p}{,} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,}\PY{n}{yy}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gaussian fit: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PYZbs{}
        \PY{o}{+} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sigma\PYZca{}2\PYZdl{} = }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sigma2}\PY{p}{,} \PY{n}{err\PYZus{}sigma2}\PY{p}{)} \PYZbs{}
         \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{ N = }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{N}\PY{p}{,} \PY{n}{err\PYZus{}N}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{minorticks\PYZus{}on}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lag time: \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{Delta=\PYZdl{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{ days}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{tau}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_34_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Relevant Lag times (1, 4, 7, 14, 21, 30, 90,
365)}\label{relevant-lag-times-1-4-7-14-21-30-90-365}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tau\PYZus{}vals\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{,} \PY{l+m+mi}{90}\PY{p}{,} \PY{l+m+mi}{365}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{plot\PYZus{}PDF}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{xlimit}\PY{p}{,} \PY{n}{n\PYZus{}bins}\PY{p}{,} \PY{n}{y\PYZus{}max}\PY{p}{,} \PY{n}{c}\PY{p}{)}\PY{p}{:}
    \PY{n}{NTL\PYZus{}dx} \PY{o}{=} \PY{n}{get\PYZus{}sample\PYZus{}dx}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{n}{tau}\PY{p}{)}
    \PY{n}{bin\PYZus{}edges} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{xlimit}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.}\PY{p}{,} \PY{n}{xlimit}\PY{p}{,} \PY{n}{n\PYZus{}bins}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{pdf} \PY{o}{=} \PY{n}{get\PYZus{}pdf}\PY{p}{(}\PY{n}{NTL\PYZus{}dx}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{norm}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

    \PY{n}{bin\PYZus{}centers} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{o}{*}\PY{p}{(}\PY{n}{bin\PYZus{}edges}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{bin\PYZus{}edges}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)}
    \PY{n}{sigma2}\PY{p}{,} \PY{n}{err\PYZus{}sigma2}\PY{p}{,} \PY{n}{N}\PY{p}{,} \PY{n}{err\PYZus{}N} \PY{o}{=} \PY{n}{fit\PYZus{}pdf}\PY{p}{(}\PY{n}{bin\PYZus{}centers}\PY{p}{,} \PY{n}{pdf}\PY{p}{)}
    \PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{xlimit}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.}\PY{p}{,} \PY{n}{xlimit}\PY{p}{)}
    \PY{n}{yy} \PY{o}{=} \PY{n}{gaussian}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{sigma2}\PY{p}{,} \PY{n}{N}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.4}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{stairs}\PY{p}{(}\PY{n}{pdf}\PY{p}{,} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{n}{c}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,}\PY{n}{yy}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gaussian fit: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PYZbs{}
            \PY{o}{+} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sigma\PYZca{}2\PYZdl{} = }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sigma2}\PY{p}{,} \PY{n}{err\PYZus{}sigma2}\PY{p}{)} \PYZbs{}
             \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{ N = }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{N}\PY{p}{,} \PY{n}{err\PYZus{}N}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{minorticks\PYZus{}on}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lag time: \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau=\PYZdl{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{ days}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{tau}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{y\PYZus{}max}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tau\PYZus{}vals\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{,} \PY{l+m+mi}{90}\PY{p}{,} \PY{l+m+mi}{365}\PY{p}{]}\PY{p}{)}

\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plot\PYZus{}PDF}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{xlimit} \PY{o}{=} \PY{l+m+mi}{25}\PY{p}{,} \PY{n}{n\PYZus{}bins} \PY{o}{=} \PY{l+m+mi}{50}\PY{p}{,} \PY{n}{y\PYZus{}max} \PY{o}{=} \PY{l+m+mf}{0.25}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{plasma}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Log-spaced time intervals (1, 3, 10, 31, 100, 316, 1000,
3162)}\label{log-spaced-time-intervals-1-3-10-31-100-316-1000-3162}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{n\PYZus{}delta\PYZus{}init} \PY{o}{=} \PY{l+m+mi}{8} \PY{c+c1}{\PYZsh{} later, can increase this}
\PY{n}{logdelta\PYZus{}min} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{logdelta\PYZus{}max} \PY{o}{=} \PY{l+m+mf}{3.2}
\PY{n}{delta\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{floor}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{logdelta\PYZus{}min}\PY{p}{,} \PY{n}{logdelta\PYZus{}max}\PY{p}{,} \PY{n}{n\PYZus{}delta\PYZus{}init}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{delta\PYZus{}vals}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([   1,    2,    8,   23,   67,  193,  553, 1584])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plot\PYZus{}PDF}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{xlimit} \PY{o}{=} \PY{l+m+mi}{25}\PY{p}{,} \PY{n}{n\PYZus{}bins} \PY{o}{=} \PY{l+m+mi}{50}\PY{p}{,} \PY{n}{y\PYZus{}max} \PY{o}{=} \PY{l+m+mf}{0.25}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{plasma}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_41_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Generating MSDs}\label{generating-msds}

    \subsubsection{Discrete Lag Times}\label{discrete-lag-times}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{p}{)}

\PY{n}{n\PYZus{}delta\PYZus{}init} \PY{o}{=} \PY{l+m+mi}{30} \PY{c+c1}{\PYZsh{} later, can increase this}
\PY{n}{logdelta\PYZus{}min} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{logdelta\PYZus{}max} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{n}\PY{p}{)}
\PY{n}{delta\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{floor}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{logdelta\PYZus{}min}\PY{p}{,} \PY{n}{logdelta\PYZus{}max}\PY{p}{,} \PY{n}{n\PYZus{}delta\PYZus{}init}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{delta\PYZus{}vals}

\PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{)}
\PY{n}{dx\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}
\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{delta} \PY{o}{=} \PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{data\PYZus{}trunc} \PY{o}{=} \PY{n}{data\PYZus{}sample}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{delta}\PY{p}{]}
    \PY{n}{data\PYZus{}shift} \PY{o}{=} \PY{n}{data\PYZus{}sample}\PY{p}{[}\PY{n}{delta}\PY{p}{:}\PY{p}{]}
    \PY{n}{dx} \PY{o}{=} \PY{n}{data\PYZus{}shift}\PY{o}{.}\PY{n}{values} \PY{o}{\PYZhy{}} \PY{n}{data\PYZus{}trunc}\PY{o}{.}\PY{n}{values}
    \PY{n}{dx\PYZus{}tau}\PY{p}{[}\PY{p}{:}\PY{n+nb}{len}\PY{p}{(}\PY{n}{dx}\PY{p}{)}\PY{p}{,} \PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{dx}\PY{o}{.}\PY{n}{T}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
28it [00:00, 5908.66it/s]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} np.log10(n)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{msd\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}
\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{)}\PY{p}{:}
    \PY{n}{dx2\PYZus{}sum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nansum}\PY{p}{(}\PY{n}{dx\PYZus{}tau}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{c+c1}{\PYZsh{} returns sum treating NaNs as zero}
    \PY{n}{denom} \PY{o}{=} \PY{n}{n}\PY{o}{\PYZhy{}}\PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{msd\PYZus{}tau}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{dx2\PYZus{}sum}\PY{o}{/}\PY{n}{denom}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{show\PYZus{}markers}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{7}\PY{p}{:} \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{year}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{l+m+mi}{7}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{multiples of 1 week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{365}\PY{p}{:} \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{year}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{l+m+mi}{365}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{multiples of 1 year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
\PY{n}{show\PYZus{}markers}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{minorticks\PYZus{}on}\PY{p}{(}\PY{p}{)}


\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
\PY{n}{show\PYZus{}markers}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{)}
\PY{n}{msd\PYZus{}theo} \PY{o}{=} \PY{n}{delta\PYZus{}vals}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{} plt.minorticks\PYZus{}on() }

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_48_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Here we can see a particular periodicity in the MSD plots, however, take
note that we are using a discretize set of delta values that are
log-spaced. NTL is an output of a complex system of nocturnal lighting
from artificial and natural sources hence, I reckon that each timescale
(and thus lag-time) must be investigated by plotting its corresponding
MSD.

    \subsubsection{Continuous Lag Times}\label{continuous-lag-times}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{p}{)}
\PY{n}{tau\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{,} \PY{n}{n\PYZus{}tau}\PY{p}{)}
\PY{n}{delta\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}

\PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\PY{n}{n\PYZus{}samp} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{p}{)}
\PY{n}{dx\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}
\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{delta} \PY{o}{=} \PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{data\PYZus{}trunc} \PY{o}{=} \PY{n}{data\PYZus{}sample}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{delta}\PY{p}{]}
    \PY{n}{data\PYZus{}shift} \PY{o}{=} \PY{n}{data\PYZus{}sample}\PY{p}{[}\PY{n}{delta}\PY{p}{:}\PY{p}{]}
    \PY{n}{dx} \PY{o}{=} \PY{n}{data\PYZus{}shift}\PY{o}{.}\PY{n}{values} \PY{o}{\PYZhy{}} \PY{n}{data\PYZus{}trunc}\PY{o}{.}\PY{n}{values}
    \PY{n}{dx\PYZus{}tau}\PY{p}{[}\PY{p}{:}\PY{n+nb}{len}\PY{p}{(}\PY{n}{dx}\PY{p}{)}\PY{p}{,} \PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{dx}\PY{o}{.}\PY{n}{T}
    
\PY{n}{msd\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{,} \PY{n}{n\PYZus{}samp}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}
\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{p}{)}\PY{p}{:}
    \PY{n}{dx2\PYZus{}sum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nansum}\PY{p}{(}\PY{n}{dx\PYZus{}tau}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{c+c1}{\PYZsh{} returns sum treating NaNs as zero}
    \PY{n}{denom} \PY{o}{=} \PY{n}{n}\PY{o}{\PYZhy{}}\PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{msd\PYZus{}tau}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{dx2\PYZus{}sum}\PY{o}{/}\PY{n}{denom}

\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
\PY{n}{show\PYZus{}markers}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{minorticks\PYZus{}on}\PY{p}{(}\PY{p}{)}


\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
\PY{n}{show\PYZus{}markers}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{msd\PYZus{}theo} \PY{o}{=} \PY{n}{tau\PYZus{}vals}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{minorticks\PYZus{}on}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
4142it [00:00, 16721.99it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_51_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Markers indicating multiples of the week and year are displayed as the
magenta and cyan lines, respectively. Noticeably, a linear and
exponential regime in the MSD is evident in the weekly and yearly
timescales.

    \subsubsection{Automating the plots}\label{automating-the-plots}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{MSD\PYZus{}plotted}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
    \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
    \PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{drawstyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{steps\PYZhy{}mid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{datetime}\PY{o}{.}\PY{n}{date}\PY{p}{(}\PY{l+m+mi}{2012}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{19}\PY{p}{)}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n+nb}{str}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
             \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{7}\PY{p}{,} \PY{n}{bbox}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{facecolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{white}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Radiance, \PYZdl{}nW·cm\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−2\PYZcb{}·sr\PYZca{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{−1\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
    \PY{n}{tau\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{,} \PY{n}{n\PYZus{}tau}\PY{p}{)}
    \PY{n}{delta\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}

    \PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
    \PY{n}{n\PYZus{}samp} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{p}{)}
    \PY{n}{dx\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}

    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{n}{delta} \PY{o}{=} \PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
        \PY{n}{data\PYZus{}trunc} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{delta}\PY{p}{]}
        \PY{n}{data\PYZus{}shift} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{delta}\PY{p}{:}\PY{p}{]}
        \PY{n}{dx} \PY{o}{=} \PY{n}{data\PYZus{}shift}\PY{o}{.}\PY{n}{values} \PY{o}{\PYZhy{}} \PY{n}{data\PYZus{}trunc}\PY{o}{.}\PY{n}{values}
        \PY{n}{dx\PYZus{}tau}\PY{p}{[}\PY{p}{:}\PY{n+nb}{len}\PY{p}{(}\PY{n}{dx}\PY{p}{)}\PY{p}{,} \PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{dx}\PY{o}{.}\PY{n}{T}

    \PY{n}{msd\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{,} \PY{n}{n\PYZus{}samp}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}
    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{p}{)}\PY{p}{:}
        \PY{n}{dx2\PYZus{}sum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nansum}\PY{p}{(}\PY{n}{dx\PYZus{}tau}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{denom} \PY{o}{=} \PY{n}{n}\PY{o}{\PYZhy{}}\PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
        \PY{n}{msd\PYZus{}tau}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{dx2\PYZus{}sum}\PY{o}{/}\PY{n}{denom}

    \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
    \PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
    \PY{n}{show\PYZus{}markers}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{minorticks\PYZus{}on}\PY{p}{(}\PY{p}{)}


    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
    \PY{n}{show\PYZus{}markers}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{)}
    \PY{n}{msd\PYZus{}theo} \PY{o}{=} \PY{n}{tau\PYZus{}vals}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{minorticks\PYZus{}on}\PY{p}{(}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{{[}MSD{]} NTL data}\label{msd-ntl-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}plotted}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
4142it [00:00, 16427.58it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_56_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_56_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Using the untreated raw data renders a seemingly subdiffusive MSD plot,
however, it's reliability is still in question especially that roughly
half of the data is missing due to cloud cover.

    \subsubsection{{[}MSD{]} Gap Filled NTL
data}\label{msd-gap-filled-ntl-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}plotted}\PY{p}{(}\PY{n}{NTL\PYZus{}GF}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
4142it [00:00, 17080.07it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_59_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_59_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    With Gap Filling algorithm on Black Marble, the data is now more
continious and corrected for all the other effects. We can see here a
periodic fluctuation in MSD but overall an increasing trend through
larger lag times. NTL has been established to represent long term
economic progression hence, this increase in trend is captures by
setting larger values of \(\tau\).

    \subsubsection{{[}MSD{]} Lunar Irradiance
data}\label{msd-lunar-irradiance-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{38}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}plotted}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DNB\PYZus{}Lunar\PYZus{}Irradiance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
4142it [00:00, 17363.24it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_62_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_62_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    A layer of VNP46A2 accounts for the lunar effects that is used for
correction and here we can see that the MSD periodically drops on
multiples of 4 weeks, which is representative of one lunar cycle.

    \subsubsection{{[}MSD{]} Latest High Quality Retrieval data (in unit of
days)}\label{msd-latest-high-quality-retrieval-data-in-unit-of-days}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{39}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}plotted}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latest\PYZus{}High\PYZus{}Quality\PYZus{}Retrieval}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
4142it [00:00, 16955.32it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{MSD for Regional Gap Filled NTL
data}\label{msd-for-regional-gap-filled-ntl-data}

    In this portion, the MSD for the NTL values aggregated on a regional
scale is shown and characteristic behaviors were observed. However, a
further data processing is needed to clean some of the datasets with
extreme outliers which eventually affected the MSD plots.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{40}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{os}

\PY{n}{data\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../Project/data/VNP46A2\PYZus{}regional/}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{regional\PYZus{}NTL} \PY{o}{=} \PY{p}{[}\PY{n}{f} \PY{k}{for} \PY{n}{f} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{data\PYZus{}path}\PY{p}{)} \PY{k}{if} \PY{o+ow}{not} \PY{n}{f}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
\PY{n}{regional\PYZus{}NTL}
\PY{c+c1}{\PYZsh{} \PYZdq{}../data//}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{40}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['Region XII\_NTL\_VNP46A2.csv',
 'Region VI\_NTL\_VNP46A2.csv',
 'Region II\_NTL\_VNP46A2.csv',
 'ARMM\_NTL\_VNP46A2.csv',
 'Region IV-A\_NTL\_VNP46A2.csv',
 'Region I\_NTL\_VNP46A2.csv',
 'Region XI\_NTL\_VNP46A2.csv',
 'Region IX\_NTL\_VNP46A2.csv',
 'Region III\_NTL\_VNP46A2.csv',
 'NCR\_NTL\_VNP46A2.csv',
 'Region XIII\_NTL\_VNP46A2.csv',
 'Region VII\_NTL\_VNP46A2.csv',
 'Region VIII\_NTL\_VNP46A2.csv',
 'Region X\_NTL\_VNP46A2.csv',
 'CAR\_NTL\_VNP46A2.csv']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{outlier\PYZus{}removal}\PY{p}{(}\PY{n}{dataframe}\PY{p}{)}\PY{p}{:}
    \PY{n}{q\PYZus{}low} \PY{o}{=} \PY{n}{dataframe}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{l+m+mf}{0.01}\PY{p}{)}
    \PY{n}{q\PYZus{}hi}  \PY{o}{=} \PY{n}{dataframe}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{l+m+mf}{0.99}\PY{p}{)}
    \PY{n}{dataframe} \PY{o}{=} \PY{n}{dataframe}\PY{p}{[}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{q\PYZus{}hi}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{q\PYZus{}low}\PY{p}{)}\PY{p}{]}
    \PY{k}{return} \PY{n}{dataframe}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{regions} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{BM\PYZus{}NTL} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{MSD\PYZus{}reg\PYZus{}NTL} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{NTL\PYZus{}data} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{regional\PYZus{}NTL}\PY{p}{)}\PY{p}{:}
    
    \PY{n}{regions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL\PYZus{}data}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{16}\PY{p}{]}\PY{p}{)}\PY{p}{)}

    \PY{n}{dataframe} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{data\PYZus{}path} \PY{o}{+} \PY{n}{NTL\PYZus{}data}\PY{p}{,} \PY{n}{parse\PYZus{}dates}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{index\PYZus{}col} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)} 
                            \PY{c+c1}{\PYZsh{}encoding=\PYZsq{}unicode\PYZus{}escape\PYZsq{}, error\PYZus{}bad\PYZus{}lines=False)    }
    \PY{n}{dataframe} \PY{o}{=} \PY{n}{outlier\PYZus{}removal}\PY{p}{(}\PY{n}{dataframe}\PY{p}{)}
    \PY{n}{data} \PY{o}{=} \PY{n}{dataframe}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    
    \PY{n}{BM\PYZus{}NTL}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{data}\PY{p}{)}
    
    \PY{n}{date\PYZus{}range} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{date\PYZus{}range}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2012\PYZhy{}01\PYZhy{}19}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2023\PYZhy{}06\PYZhy{}12}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{data\PYZus{}reindexed} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{reindex}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{)}
    \PY{n}{NTL\PYZus{}missing\PYZus{}dates} \PY{o}{=} \PY{n}{data\PYZus{}reindexed}\PY{p}{[}\PY{n}{data\PYZus{}reindexed}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{p}{]}
    \PY{n}{no\PYZus{}obs} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{NTL\PYZus{}missing\PYZus{}dates}\PY{p}{)}

\PY{c+c1}{\PYZsh{}     plt.figure(dpi = 150, figsize = (15,3))}
\PY{c+c1}{\PYZsh{}     plt.grid()}
\PY{c+c1}{\PYZsh{}     plt.plot(data, \PYZsq{}g.\PYZhy{}\PYZsq{}, drawstyle = \PYZsq{}steps\PYZhy{}mid\PYZsq{}, alpha = 0.5, ms = 1, lw = 1)}
\PY{c+c1}{\PYZsh{}     plt.text(datetime.date(2012, 1, 19), data.mean()*2, str(data.describe()),}
\PY{c+c1}{\PYZsh{}              fontsize=7, bbox=dict(facecolor=\PYZsq{}white\PYZsq{}, alpha=0.8))}
\PY{c+c1}{\PYZsh{}     plt.title(NTL\PYZus{}data[:\PYZhy{}4] + \PYZsq{} (Days with NTL data: \PYZsq{} + str(len(data) \PYZhy{} no\PYZus{}obs) + \PYZsq{})\PYZsq{})}
\PY{c+c1}{\PYZsh{}     plt.scatter(NTL\PYZus{}missing\PYZus{}dates.index, [0] * no\PYZus{}obs, color=\PYZsq{}orange\PYZsq{}, marker=\PYZsq{}x\PYZsq{},}
\PY{c+c1}{\PYZsh{}             label=\PYZsq{}No sensor data record  (\PYZsq{} + str(no\PYZus{}obs) + \PYZsq{} observations)\PYZsq{})}
\PY{c+c1}{\PYZsh{} \PYZsh{}     plt.savefig(\PYZdq{}../results/\PYZdq{} + str(NTL\PYZus{}data[:\PYZhy{}4]) + \PYZdq{}.png\PYZdq{})}
\PY{c+c1}{\PYZsh{}     plt.show()}

    \PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
    \PY{n}{tau\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{,} \PY{n}{n\PYZus{}tau}\PY{p}{)}
    \PY{n}{delta\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}

    \PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
    \PY{n}{n\PYZus{}samp} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{p}{)}
    \PY{n}{dx\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}
    \PY{n}{msd\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{,} \PY{n}{n\PYZus{}samp}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}

    
    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{n}{delta} \PY{o}{=} \PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
        \PY{n}{data\PYZus{}trunc} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{delta}\PY{p}{]}
        \PY{n}{data\PYZus{}shift} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{delta}\PY{p}{:}\PY{p}{]}
        \PY{n}{dx} \PY{o}{=} \PY{n}{data\PYZus{}shift}\PY{o}{.}\PY{n}{values} \PY{o}{\PYZhy{}} \PY{n}{data\PYZus{}trunc}\PY{o}{.}\PY{n}{values}
        \PY{n}{dx\PYZus{}tau}\PY{p}{[}\PY{p}{:}\PY{n+nb}{len}\PY{p}{(}\PY{n}{dx}\PY{p}{)}\PY{p}{,} \PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{dx}\PY{o}{.}\PY{n}{T}
        \PY{n}{dx2\PYZus{}sum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nansum}\PY{p}{(}\PY{n}{dx}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{denom} \PY{o}{=} \PY{n}{n}\PY{o}{\PYZhy{}}\PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
        \PY{n}{msd} \PY{o}{=} \PY{n}{dx2\PYZus{}sum}\PY{o}{/}\PY{n}{denom}
        \PY{n}{msd\PYZus{}tau}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{msd}

    \PY{n}{msd\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{,} \PY{n}{n\PYZus{}samp}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}
    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals}\PY{p}{)}\PY{p}{:}
        \PY{n}{dx2\PYZus{}sum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nansum}\PY{p}{(}\PY{n}{dx\PYZus{}tau}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{denom} \PY{o}{=} \PY{n}{n}\PY{o}{\PYZhy{}}\PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
        \PY{n}{msd\PYZus{}tau}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{dx2\PYZus{}sum}\PY{o}{/}\PY{n}{denom}
        
    \PY{n}{MSD\PYZus{}reg\PYZus{}NTL}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{msd\PYZus{}tau}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|                                                    | 0/15 [00:00<?, ?it/s]
0it [00:00, ?it/s]
1360it [00:00, 13595.22it/s]
4027it [00:00, 14063.30it/s]
  7\%|██▉                                         | 1/15 [00:00<00:05,  2.37it/s]
0it [00:00, ?it/s]
1409it [00:00, 14085.08it/s]
4028it [00:00, 14635.52it/s]
 13\%|█████▊                                      | 2/15 [00:00<00:05,  2.41it/s]
0it [00:00, ?it/s]
1401it [00:00, 14005.37it/s]
4027it [00:00, 14473.38it/s]
 20\%|████████▊                                   | 3/15 [00:01<00:04,  2.51it/s]
0it [00:00, ?it/s]
1290it [00:00, 12897.43it/s]
4031it [00:00, 13987.55it/s]
 27\%|███████████▋                                | 4/15 [00:01<00:04,  2.44it/s]
0it [00:00, ?it/s]
1399it [00:00, 13985.15it/s]
4023it [00:00, 14497.35it/s]
 33\%|██████████████▋                             | 5/15 [00:02<00:03,  2.51it/s]
0it [00:00, ?it/s]
1457it [00:00, 14568.38it/s]
4029it [00:00, 14864.90it/s]
 40\%|█████████████████▌                          | 6/15 [00:02<00:03,  2.56it/s]
0it [00:00, ?it/s]
1444it [00:00, 14438.71it/s]
4027it [00:00, 14708.36it/s]
 47\%|████████████████████▌                       | 7/15 [00:02<00:03,  2.58it/s]
0it [00:00, ?it/s]
1366it [00:00, 13654.12it/s]
4027it [00:00, 14448.30it/s]
 53\%|███████████████████████▍                    | 8/15 [00:03<00:02,  2.53it/s]
0it [00:00, ?it/s]
1427it [00:00, 14262.43it/s]
4029it [00:00, 14104.08it/s]
 60\%|██████████████████████████▍                 | 9/15 [00:03<00:02,  2.49it/s]
0it [00:00, ?it/s]
1446it [00:00, 14451.02it/s]
4023it [00:00, 14888.04it/s]
 67\%|████████████████████████████▋              | 10/15 [00:03<00:01,  2.54it/s]
0it [00:00, ?it/s]
1466it [00:00, 14656.83it/s]
4028it [00:00, 14892.89it/s]
 73\%|███████████████████████████████▌           | 11/15 [00:04<00:01,  2.59it/s]
0it [00:00, ?it/s]
1344it [00:00, 13435.27it/s]
4028it [00:00, 14399.13it/s]
 80\%|██████████████████████████████████▍        | 12/15 [00:04<00:01,  2.51it/s]
0it [00:00, ?it/s]
1451it [00:00, 14504.79it/s]
4028it [00:00, 14959.63it/s]
 87\%|█████████████████████████████████████▎     | 13/15 [00:05<00:00,  2.57it/s]
0it [00:00, ?it/s]
1429it [00:00, 14284.26it/s]
4027it [00:00, 14702.18it/s]
 93\%|████████████████████████████████████████▏  | 14/15 [00:05<00:00,  2.60it/s]
0it [00:00, ?it/s]
1481it [00:00, 14807.47it/s]
4024it [00:00, 15121.34it/s]
100\%|███████████████████████████████████████████| 15/15 [00:05<00:00,  2.55it/s]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{itertools}
\PY{n}{marker} \PY{o}{=} \PY{n}{itertools}\PY{o}{.}\PY{n}{cycle}\PY{p}{(}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} 
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} show\PYZus{}markers()}
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{regions}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{BM\PYZus{}NTL}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n}{regions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{,} \PY{n}{ncol} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                \PY{n}{bbox\PYZus{}transform}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transAxes}\PY{p}{,} \PY{n}{fancybox} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_72_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} show\PYZus{}markers()}
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{regions}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{4000}\PY{p}{]}\PY{p}{,} \PY{n}{MSD\PYZus{}reg\PYZus{}NTL}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{4000}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n}{regions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{ncol} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                \PY{n}{bbox\PYZus{}transform}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transAxes}\PY{p}{,} \PY{n}{fancybox} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}    
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{4000}\PY{p}{]}\PY{p}{,} \PY{n}{MSD\PYZus{}reg\PYZus{}NTL}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{4000}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n}{regions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{ncol} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                \PY{n}{bbox\PYZus{}transform}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transAxes}\PY{p}{,} \PY{n}{fancybox} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{date} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{index}
\PY{n}{y} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
\PY{n}{decomposition} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{tsa}\PY{o}{.}\PY{n}{seasonal\PYZus{}decompose}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{model}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{additive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{period}\PY{o}{=}\PY{l+m+mi}{365}\PY{p}{)}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{sharex}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{col}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{n}{gridspec\PYZus{}kw}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{height\PYZus{}ratios}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1} \PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{,}
                       \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}


\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{c+c1}{\PYZsh{} ax[0].plot(date, y\PYZhy{}0.3, \PYZsq{}k\PYZsq{}, lw = 0.5, drawstyle = \PYZsq{}steps\PYZhy{}mid\PYZsq{})}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{date}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.3}\PY{p}{,} \PY{n}{drawstyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{steps\PYZhy{}mid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Daily NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{date}\PY{p}{,} \PY{n}{decomposition}\PY{o}{.}\PY{n}{seasonal}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{date}\PY{p}{,} \PY{n}{decomposition}\PY{o}{.}\PY{n}{trend}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{)}
\PY{c+c1}{\PYZsh{} ax[0].bar(date, decomposition.resid, width = 10,}
\PY{c+c1}{\PYZsh{}         color = plt.cm.Spectral(decomposition.resid), alpha = 0.5)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Radiance, \PYZdl{}nW ·cm−2·sr−1\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{date}\PY{p}{,} \PY{n}{decomposition}\PY{o}{.}\PY{n}{trend}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{date}\PY{p}{,} \PY{n}{decomposition}\PY{o}{.}\PY{n}{seasonal}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seasonality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{residual} \PY{o}{=} \PY{n}{decomposition}\PY{o}{.}\PY{n}{resid}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{date}\PY{p}{,} \PY{n}{residual}\PY{p}{,} \PY{n}{width} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{residual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{date}\PY{p}{,} \PY{n}{residual}\PY{p}{,} \PY{n}{width} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,}
        \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Spectral}\PY{p}{(}\PY{n}{residual}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_74_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}plotted}\PY{p}{(}\PY{n}{decomposition}\PY{o}{.}\PY{n}{trend}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
4024it [00:00, 17379.36it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_75_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_75_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}plotted}\PY{p}{(}\PY{n}{decomposition}\PY{o}{.}\PY{n}{seasonal}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
4024it [00:00, 18189.13it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_76_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_76_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}plotted}\PY{p}{(}\PY{n}{decomposition}\PY{o}{.}\PY{n}{resid}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
4024it [00:00, 18011.54it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_77_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_77_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{STL Disaggregation}\label{stl-disaggregation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{date\PYZus{}range} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{date\PYZus{}range}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2012\PYZhy{}01\PYZhy{}19}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2023\PYZhy{}06\PYZhy{}12}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NTL\PYZus{}dataframe} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n}{date\PYZus{}range}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{n}{regions}\PY{p}{)}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{NTL\PYZus{}data} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{regional\PYZus{}NTL}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{region\PYZus{}name} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NTL\PYZus{}data}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{16}\PY{p}{]}\PY{p}{)}
    \PY{n}{dataframe} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{data\PYZus{}path}\PY{o}{+}\PY{n}{NTL\PYZus{}data}\PY{p}{,} \PY{n}{parse\PYZus{}dates}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{index\PYZus{}col} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}
    \PY{n}{dataframe} \PY{o}{=} \PY{n}{outlier\PYZus{}removal}\PY{p}{(}\PY{n}{dataframe}\PY{p}{)}
    \PY{n}{data} \PY{o}{=} \PY{n}{dataframe}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gap\PYZus{}Filled\PYZus{}DNB\PYZus{}BRDF\PYZus{}Corrected\PYZus{}NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n}{NTL\PYZus{}dataframe}\PY{p}{[}\PY{n}{region\PYZus{}name}\PY{p}{]} \PY{o}{=} \PY{n}{data}

\PY{n}{NTL\PYZus{}dataframe} \PY{o}{=} \PY{n}{NTL\PYZus{}dataframe}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
\PY{n}{NTL\PYZus{}dataframe}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
15it [00:00, 146.29it/s]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            Region XII  Region VI  Region II      ARMM  Region IV-A  Region I  \textbackslash{}
2012-02-01    0.255548   0.265215   0.106332  0.145240     0.760943  0.241235
2012-02-07    0.190200   0.248554   0.161585  0.100597     0.697233  0.307927
2012-02-22    0.416381   0.437064   0.147420  0.233590     0.839748  0.301901
2012-03-01    0.202689   0.230419   0.153269  0.146789     0.728833  0.343267
2012-03-30    0.335825   0.243452   0.127459  0.227050     0.986920  0.236392
{\ldots}                {\ldots}        {\ldots}        {\ldots}       {\ldots}          {\ldots}       {\ldots}
2023-06-05    0.499731   0.614557   0.390572  0.333457     1.694334  0.734452
2023-06-06    0.500282   0.614681   0.384512  0.333363     1.844656  0.460213
2023-06-07    0.501796   0.643477   0.417970  0.338322     1.762237  0.491732
2023-06-08    0.478718   0.605783   0.463181  0.346712     1.613582  0.686410
2023-06-09    0.499206   0.608347   0.423989  0.333517     1.912941  0.732638

            Region XI  Region IX  Region III        NCR  Region XIII  \textbackslash{}
2012-02-01   0.255569   0.148089    0.523322  19.328243     0.171012
2012-02-07   0.279010   0.162171    0.490516  18.677756     0.148958
2012-02-22   0.403943   0.294492    0.549518  21.074646     0.113008
2012-03-01   0.266870   0.191876    0.531180  20.088517     0.148395
2012-03-30   0.514605   0.169705    0.520133  20.602305     0.469626
{\ldots}               {\ldots}        {\ldots}         {\ldots}        {\ldots}          {\ldots}
2023-06-05   0.622483   0.369410    1.255704  27.632227     0.345752
2023-06-06   0.624900   0.367840    1.351284  29.206725     0.340411
2023-06-07   0.624199   0.337550    1.232464  21.419392     0.353631
2023-06-08   0.626030   0.375604    1.195275  25.594652     0.345418
2023-06-09   0.624136   0.367627    1.335912  29.242508     0.342823

            Region VII  Region VIII  Region X       CAR
2012-02-01    0.476129     0.161637  0.265277  0.116291
2012-02-07    0.455531     0.135995  0.221112  0.228377
2012-02-22    0.761889     0.310421  0.344442  0.153618
2012-03-01    0.416914     0.131036  0.254962  0.185645
2012-03-30    0.617597     0.387795  0.558380  0.130193
{\ldots}                {\ldots}          {\ldots}       {\ldots}       {\ldots}
2023-06-05    0.959122     0.326172  0.469475  0.313130
2023-06-06    0.959293     0.434871  0.468813  0.248978
2023-06-07    1.004529     0.488281  0.516072  0.194136
2023-06-08    0.966404     0.403146  0.482180  0.399595
2023-06-09    0.959076     0.395628  0.469667  0.321617

[3637 rows x 15 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{trend} \PY{o}{=} \PY{n}{NTL\PYZus{}dataframe}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\PY{n}{seasonality} \PY{o}{=} \PY{n}{NTL\PYZus{}dataframe}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\PY{n}{residual} \PY{o}{=} \PY{n}{NTL\PYZus{}dataframe}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

\PY{k}{for} \PY{n}{loc} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{NTL\PYZus{}dataframe}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{STL Decomposition}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{data} \PY{o}{=} \PY{n}{NTL\PYZus{}dataframe}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{o}{.}\PY{n}{values}
    \PY{n}{decomposition} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{tsa}\PY{o}{.}\PY{n}{seasonal\PYZus{}decompose}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{model}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{additive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{period} \PY{o}{=} \PY{l+m+mi}{365}\PY{p}{)}
    \PY{n}{trend}\PY{p}{[}\PY{n}{loc}\PY{p}{]} \PY{o}{=} \PY{n}{decomposition}\PY{o}{.}\PY{n}{trend}
    \PY{n}{seasonality}\PY{p}{[}\PY{n}{loc}\PY{p}{]} \PY{o}{=} \PY{n}{decomposition}\PY{o}{.}\PY{n}{seasonal}
    \PY{n}{residual}\PY{p}{[}\PY{n}{loc}\PY{p}{]} \PY{o}{=} \PY{n}{decomposition}\PY{o}{.}\PY{n}{resid}
    
\PY{n}{NTL\PYZus{}DF} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{NTL\PYZus{}dataframe}\PY{p}{,}\PY{n}{trend}\PY{p}{,} \PY{n}{seasonality}\PY{p}{,} \PY{n}{residual}\PY{p}{]}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{keys} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Trend}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Seasonality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Residual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{NTL\PYZus{}DF}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
STL Decomposition: 100\%|███████████████████████| 15/15 [00:00<00:00, 248.99it/s]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                  NTL                                                      \textbackslash{}
           Region XII Region VI Region II      ARMM Region IV-A  Region I
2012-02-01   0.255548  0.265215  0.106332  0.145240    0.760943  0.241235
2012-02-07   0.190200  0.248554  0.161585  0.100597    0.697233  0.307927
2012-02-22   0.416381  0.437064  0.147420  0.233590    0.839748  0.301901
2012-03-01   0.202689  0.230419  0.153269  0.146789    0.728833  0.343267
2012-03-30   0.335825  0.243452  0.127459  0.227050    0.986920  0.236392
{\ldots}               {\ldots}       {\ldots}       {\ldots}       {\ldots}         {\ldots}       {\ldots}
2023-06-05   0.499731  0.614557  0.390572  0.333457    1.694334  0.734452
2023-06-06   0.500282  0.614681  0.384512  0.333363    1.844656  0.460213
2023-06-07   0.501796  0.643477  0.417970  0.338322    1.762237  0.491732
2023-06-08   0.478718  0.605783  0.463181  0.346712    1.613582  0.686410
2023-06-09   0.499206  0.608347  0.423989  0.333517    1.912941  0.732638

                                                      {\ldots} Residual            \textbackslash{}
           Region XI Region IX Region III        NCR  {\ldots} Region I Region XI
2012-02-01  0.255569  0.148089   0.523322  19.328243  {\ldots}      NaN       NaN
2012-02-07  0.279010  0.162171   0.490516  18.677756  {\ldots}      NaN       NaN
2012-02-22  0.403943  0.294492   0.549518  21.074646  {\ldots}      NaN       NaN
2012-03-01  0.266870  0.191876   0.531180  20.088517  {\ldots}      NaN       NaN
2012-03-30  0.514605  0.169705   0.520133  20.602305  {\ldots}      NaN       NaN
{\ldots}              {\ldots}       {\ldots}        {\ldots}        {\ldots}  {\ldots}      {\ldots}       {\ldots}
2023-06-05  0.622483  0.369410   1.255704  27.632227  {\ldots}      NaN       NaN
2023-06-06  0.624900  0.367840   1.351284  29.206725  {\ldots}      NaN       NaN
2023-06-07  0.624199  0.337550   1.232464  21.419392  {\ldots}      NaN       NaN
2023-06-08  0.626030  0.375604   1.195275  25.594652  {\ldots}      NaN       NaN
2023-06-09  0.624136  0.367627   1.335912  29.242508  {\ldots}      NaN       NaN

                                                                        \textbackslash{}
           Region IX Region III NCR Region XIII Region VII Region VIII
2012-02-01       NaN        NaN NaN         NaN        NaN         NaN
2012-02-07       NaN        NaN NaN         NaN        NaN         NaN
2012-02-22       NaN        NaN NaN         NaN        NaN         NaN
2012-03-01       NaN        NaN NaN         NaN        NaN         NaN
2012-03-30       NaN        NaN NaN         NaN        NaN         NaN
{\ldots}              {\ldots}        {\ldots}  ..         {\ldots}        {\ldots}         {\ldots}
2023-06-05       NaN        NaN NaN         NaN        NaN         NaN
2023-06-06       NaN        NaN NaN         NaN        NaN         NaN
2023-06-07       NaN        NaN NaN         NaN        NaN         NaN
2023-06-08       NaN        NaN NaN         NaN        NaN         NaN
2023-06-09       NaN        NaN NaN         NaN        NaN         NaN


           Region X CAR
2012-02-01      NaN NaN
2012-02-07      NaN NaN
2012-02-22      NaN NaN
2012-03-01      NaN NaN
2012-03-30      NaN NaN
{\ldots}             {\ldots}  ..
2023-06-05      NaN NaN
2023-06-06      NaN NaN
2023-06-07      NaN NaN
2023-06-08      NaN NaN
2023-06-09      NaN NaN

[3637 rows x 60 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{MSD\PYZus{}calculator}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
    \PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
    \PY{n}{dt} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{delta\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{n\PYZus{}tau}\PY{p}{,} \PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}

    \PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
    \PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{)}
    \PY{n}{dx\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}
    \PY{n}{msd\PYZus{}tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{nan}

    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{delta\PYZus{}vals}\PY{p}{)}\PY{p}{:}
        \PY{n}{delta} \PY{o}{=} \PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
        \PY{n}{data\PYZus{}trunc} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{delta}\PY{p}{]}
        \PY{n}{data\PYZus{}shift} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{delta}\PY{p}{:}\PY{p}{]}
        \PY{n}{dx} \PY{o}{=} \PY{n}{data\PYZus{}shift}\PY{o}{.}\PY{n}{values} \PY{o}{\PYZhy{}} \PY{n}{data\PYZus{}trunc}\PY{o}{.}\PY{n}{values}
        \PY{n}{dx\PYZus{}tau}\PY{p}{[}\PY{p}{:}\PY{n+nb}{len}\PY{p}{(}\PY{n}{dx}\PY{p}{)}\PY{p}{,} \PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{dx}\PY{o}{.}\PY{n}{T}
        \PY{n}{dx2\PYZus{}sum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nansum}\PY{p}{(}\PY{n}{dx}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{denom} \PY{o}{=} \PY{n}{n}\PY{o}{\PYZhy{}}\PY{n}{delta\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}
        \PY{n}{msd} \PY{o}{=} \PY{n}{dx2\PYZus{}sum}\PY{o}{/}\PY{n}{denom}
        \PY{n}{msd\PYZus{}tau}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{msd}
    
    \PY{n}{MSD} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{msd\PYZus{}tau}\PY{p}{,} \PY{n}{index} \PY{o}{=} \PY{n}{delta\PYZus{}vals}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}        
    \PY{k}{return} \PY{n}{MSD}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{55}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} MSD\PYZus{}calculator(NTL\PYZus{}DF[\PYZsq{}Trend\PYZsq{}][\PYZsq{}CAR\PYZsq{}])}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{56}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}trend\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{n}{regions}\PY{p}{)}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{MSD\PYZus{}trend\PYZus{}df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{56}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
      Region XII  Region VI  Region II  ARMM  Region IV-A  Region I  \textbackslash{}
1              0          0          0     0            0         0
2              0          0          0     0            0         0
3              0          0          0     0            0         0
4              0          0          0     0            0         0
5              0          0          0     0            0         0
{\ldots}          {\ldots}        {\ldots}        {\ldots}   {\ldots}          {\ldots}       {\ldots}
4158           0          0          0     0            0         0
4159           0          0          0     0            0         0
4160           0          0          0     0            0         0
4161           0          0          0     0            0         0
4162           0          0          0     0            0         0

      Region XI  Region IX  Region III  NCR  Region XIII  Region VII  \textbackslash{}
1             0          0           0    0            0           0
2             0          0           0    0            0           0
3             0          0           0    0            0           0
4             0          0           0    0            0           0
5             0          0           0    0            0           0
{\ldots}         {\ldots}        {\ldots}         {\ldots}  {\ldots}          {\ldots}         {\ldots}
4158          0          0           0    0            0           0
4159          0          0           0    0            0           0
4160          0          0           0    0            0           0
4161          0          0           0    0            0           0
4162          0          0           0    0            0           0

      Region VIII  Region X  CAR
1               0         0    0
2               0         0    0
3               0         0    0
4               0         0    0
5               0         0    0
{\ldots}           {\ldots}       {\ldots}  {\ldots}
4158            0         0    0
4159            0         0    0
4160            0         0    0
4161            0         0    0
4162            0         0    0

[4162 rows x 15 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{loc} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Calculating MSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{MSD\PYZus{}tau} \PY{o}{=} \PY{n}{MSD\PYZus{}calculator}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Trend}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{)}
    \PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{p}{[}\PY{n}{loc}\PY{p}{]} \PY{o}{=} \PY{n}{MSD\PYZus{}tau}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Calculating MSD: 15it [00:03,  4.67it/s]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     Region XII     Region VI     Region II          ARMM  Region IV-A  \textbackslash{}
1  1.373686e-07  2.505249e-07  2.093314e-07  1.040961e-07     0.000001
2  2.627491e-07  4.790581e-07  4.009673e-07  2.027842e-07     0.000002
3  4.196534e-07  7.651666e-07  6.370537e-07  3.279231e-07     0.000004
4  6.126077e-07  1.122890e-06  9.189755e-07  4.820801e-07     0.000005
5  8.435738e-07  1.553360e-06  1.247377e-06  6.655336e-07     0.000008

       Region I     Region XI     Region IX    Region III       NCR  \textbackslash{}
1  4.324803e-07  1.769625e-07  1.184099e-07  6.713778e-07  0.000282
2  8.112249e-07  3.514803e-07  2.272876e-07  1.301591e-06  0.000561
3  1.275303e-06  5.782119e-07  3.664550e-07  2.102756e-06  0.000928
4  1.846937e-06  8.608872e-07  5.372340e-07  3.129208e-06  0.001392
5  2.537192e-06  1.200152e-06  7.401565e-07  4.399730e-06  0.001960

    Region XIII    Region VII   Region VIII      Region X           CAR
1  1.412047e-07  3.264075e-07  2.029684e-07  1.356483e-07  1.833834e-07
2  2.653071e-07  6.348276e-07  3.796273e-07  2.605023e-07  3.456291e-07
3  4.221885e-07  1.028450e-06  5.974963e-07  4.200763e-07  5.474923e-07
4  6.134459e-07  1.524209e-06  8.631643e-07  6.198094e-07  7.914536e-07
5  8.396346e-07  2.122872e-06  1.175613e-06  8.617042e-07  1.079199e-06
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}seasonality\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{n}{regions}\PY{p}{)}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{loc} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{MSD\PYZus{}seasonality\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Calculating MSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{MSD\PYZus{}tau} \PY{o}{=} \PY{n}{MSD\PYZus{}calculator}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Seasonality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{)}
    \PY{n}{MSD\PYZus{}seasonality\PYZus{}df}\PY{p}{[}\PY{n}{loc}\PY{p}{]} \PY{o}{=} \PY{n}{MSD\PYZus{}tau}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{MSD\PYZus{}seasonality\PYZus{}df}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Calculating MSD: 15it [00:03,  4.79it/s]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
      Region XII  Region VI  Region II      ARMM  Region IV-A  Region I  \textbackslash{}
1       0.000538   0.000906   0.000789  0.000336     0.003978  0.001288
2       0.000481   0.000913   0.000819  0.000321     0.003689  0.001344
3       0.000445   0.000757   0.000804  0.000287     0.002687  0.001176
4       0.000447   0.000676   0.000798  0.000281     0.002190  0.001179
5       0.000442   0.000844   0.000914  0.000318     0.003138  0.001432
{\ldots}          {\ldots}        {\ldots}        {\ldots}       {\ldots}          {\ldots}       {\ldots}
4158         NaN        NaN        NaN       NaN          NaN       NaN
4159         NaN        NaN        NaN       NaN          NaN       NaN
4160         NaN        NaN        NaN       NaN          NaN       NaN
4161         NaN        NaN        NaN       NaN          NaN       NaN
4162         NaN        NaN        NaN       NaN          NaN       NaN

      Region XI  Region IX  Region III       NCR  Region XIII  Region VII  \textbackslash{}
1      0.000514   0.000458    0.002225  0.809848     0.000525    0.001138
2      0.000496   0.000452    0.002086  0.783116     0.000486    0.001092
3      0.000433   0.000412    0.001558  0.750473     0.000509    0.000833
4      0.000471   0.000365    0.001368  0.668244     0.000514    0.000688
5      0.000478   0.000417    0.001995  0.735111     0.000546    0.001018
{\ldots}         {\ldots}        {\ldots}         {\ldots}       {\ldots}          {\ldots}         {\ldots}
4158        NaN        NaN         NaN       NaN          NaN         NaN
4159        NaN        NaN         NaN       NaN          NaN         NaN
4160        NaN        NaN         NaN       NaN          NaN         NaN
4161        NaN        NaN         NaN       NaN          NaN         NaN
4162        NaN        NaN         NaN       NaN          NaN         NaN

      Region VIII  Region X       CAR
1        0.000791  0.000476  0.000710
2        0.000801  0.000460  0.000722
3        0.000703  0.000419  0.000705
4        0.000687  0.000381  0.000743
5        0.000823  0.000455  0.000832
{\ldots}           {\ldots}       {\ldots}       {\ldots}
4158          NaN       NaN       NaN
4159          NaN       NaN       NaN
4160          NaN       NaN       NaN
4161          NaN       NaN       NaN
4162          NaN       NaN       NaN

[4162 rows x 15 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{59}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} date\PYZus{}range\PYZus{}plt = pd.date\PYZus{}range(start=\PYZsq{}2012\PYZhy{}12\PYZhy{}30\PYZsq{}, end=\PYZsq{}2024\PYZhy{}06\PYZhy{}31\PYZsq{}, freq=\PYZsq{}D\PYZsq{})}

\PY{n}{date\PYZus{}range} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{date\PYZus{}range}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2012\PYZhy{}01\PYZhy{}19}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2024\PYZhy{}06\PYZhy{}12}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}\PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{sharex}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{col}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{ax} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{ax}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Plotting the Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{loc} \PY{o}{=} \PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{facecolor} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{white}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{date\PYZus{}range}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Plotting the Values: 15it [00:00, 417.98it/s]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Text(0.5, 0, 'date')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_89_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}\PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{sharex}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{col}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{ax} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{ax}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Plotting the Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{loc} \PY{o}{=} \PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Trend}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,}
         \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Trend}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{date\PYZus{}range}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Plotting the Values: 15it [00:00, 380.93it/s]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Text(0.5, 0, 'date')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_90_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{62}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}\PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{sharex}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{col}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{ax} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{ax}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Plotting the Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{loc} \PY{o}{=} \PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     ax.plot(NTL\PYZus{}DF[\PYZsq{}Seasonality\PYZsq{}][loc]\PYZhy{}0.01, \PYZsq{}\PYZhy{}\PYZsq{}, lw = 4,}
\PY{c+c1}{\PYZsh{}          color = \PYZsq{}k\PYZsq{}, alpha = 1)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Seasonality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{date\PYZus{}range}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Plotting the Values: 15it [00:00, 472.54it/s]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{62}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Text(0.5, 0, 'date')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_91_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}\PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{sharex}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{col}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{ax} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{ax}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Plotting the Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{loc} \PY{o}{=} \PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Residual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
         \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Residual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{n}{date\PYZus{}range}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{date\PYZus{}range}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Plotting the Values: 15it [00:00, 354.08it/s]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Text(0.5, 0, 'date')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Trend and Seasonality}\label{trend-and-seasonality}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{64}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{loc} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Plotting the Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{ncol} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                \PY{n}{bbox\PYZus{}transform}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transAxes}\PY{p}{,} \PY{n}{fancybox} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Radiance, \PYZdl{}nW ·cm−2·sr−1\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
    
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Trend}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{ncol} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                \PY{n}{bbox\PYZus{}transform}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transAxes}\PY{p}{,} \PY{n}{fancybox} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Trend, \PYZdl{}nW ·cm−2·sr−1\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     plt.grid()}

\PY{c+c1}{\PYZsh{} plt.xlabel(r\PYZdq{}\PYZdl{}\PYZbs{}tau\PYZdl{}\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.ylabel(\PYZdq{}MSD\PYZdq{})}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Plotting the Values: 15it [00:00, 164.68it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_94_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{loc} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Plotting the Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
    \PY{n}{df} \PY{o}{=} \PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Seasonality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}
    \PY{n}{normalized\PYZus{}df}\PY{o}{=}\PY{p}{(}\PY{n}{df}\PY{o}{\PYZhy{}}\PY{n}{df}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{df}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{normalized\PYZus{}df}\PY{p}{[}\PY{l+m+mi}{200}\PY{p}{:}\PY{l+m+mi}{565}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     plt.legend(fontsize=10, ncol = 4, bbox\PYZus{}to\PYZus{}anchor= (0, 1.05, 1, 0.5), loc=\PYZdq{}lower left\PYZdq{},}
\PY{c+c1}{\PYZsh{}                 bbox\PYZus{}transform=plt.gca().transAxes, fancybox = True, mode=\PYZsq{}expand\PYZsq{})}
    \PY{n}{plt}\PY{o}{.}\PY{n}{gcf}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{autofmt\PYZus{}xdate}
    \PY{n}{dtFmt} \PY{o}{=} \PY{n}{mdates}\PY{o}{.}\PY{n}{DateFormatter}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} define the formatting}
    \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{xaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{dtFmt}\PY{p}{)} \PY{c+c1}{\PYZsh{} apply the format to the desired axis}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Seasonality, \PYZdl{}nW ·cm−2·sr−1\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Residual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     plt.legend(fontsize=10, ncol = 4, bbox\PYZus{}to\PYZus{}anchor= (0, 1.05, 1, 0.5), loc=\PYZdq{}lower left\PYZdq{},}
\PY{c+c1}{\PYZsh{}                 bbox\PYZus{}transform=plt.gca().transAxes, fancybox = True, mode=\PYZsq{}expand\PYZsq{})}
\PY{c+c1}{\PYZsh{}     plt.yscale(\PYZsq{}log\PYZsq{})}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL Residual, \PYZdl{}nW ·cm−2·sr−1\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}    
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Plotting the Values: 15it [00:00, 405.76it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}pdf}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{delta}\PY{p}{,} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{norm}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
    \PY{n}{dx} \PY{o}{=} \PY{n}{get\PYZus{}sample\PYZus{}dx}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{delta}\PY{p}{)}
    \PY{n}{pdf}\PY{p}{,} \PY{n}{junk} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{histogram}\PY{p}{(}\PY{n}{dx}\PY{p}{,} \PY{n}{bins} \PY{o}{=} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{density}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{k}{return} \PY{n}{pdf}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{67}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{plot\PYZus{}PDF\PYZus{}BM\PYZus{}STL}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{xlimit}\PY{p}{,} \PY{n}{n\PYZus{}bins}\PY{p}{,} \PY{n}{y\PYZus{}max}\PY{p}{,} \PY{n}{c}\PY{p}{)}\PY{p}{:}
    \PY{n}{NTL\PYZus{}dx} \PY{o}{=} \PY{n}{get\PYZus{}sample\PYZus{}dx}\PY{p}{(}\PY{n}{data\PYZus{}sample}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{n}{tau}\PY{p}{)}
    \PY{n}{bin\PYZus{}edges} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{xlimit}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.}\PY{p}{,} \PY{n}{xlimit}\PY{p}{,} \PY{n}{n\PYZus{}bins}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{pdf} \PY{o}{=} \PY{n}{get\PYZus{}pdf}\PY{p}{(}\PY{n}{NTL\PYZus{}dx}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{norm}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

    \PY{n}{bin\PYZus{}centers} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{o}{*}\PY{p}{(}\PY{n}{bin\PYZus{}edges}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{bin\PYZus{}edges}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)}
    \PY{n}{sigma2}\PY{p}{,} \PY{n}{err\PYZus{}sigma2}\PY{p}{,} \PY{n}{N}\PY{p}{,} \PY{n}{err\PYZus{}N} \PY{o}{=} \PY{n}{fit\PYZus{}pdf}\PY{p}{(}\PY{n}{bin\PYZus{}centers}\PY{p}{,} \PY{n}{pdf}\PY{p}{)}
    \PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{xlimit}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.}\PY{p}{,} \PY{n}{xlimit}\PY{p}{)}
    \PY{n}{yy} \PY{o}{=} \PY{n}{gaussian}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{sigma2}\PY{p}{,} \PY{n}{N}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.4}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{stairs}\PY{p}{(}\PY{n}{pdf}\PY{p}{,} \PY{n}{bin\PYZus{}edges}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{n}{c}\PY{p}{,} \PY{n}{edgecolor} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     plt.plot(xx,yy, \PYZsq{}b\PYZhy{}\PYZsq{}, lw = 2, alpha = 0.8, label = \PYZdq{}Gaussian fit: \PYZbs{}n\PYZdq{} \PYZbs{}}
\PY{c+c1}{\PYZsh{}             + r\PYZdq{}\PYZdl{}\PYZbs{}sigma\PYZca{}2\PYZdl{} = \PYZpc{}.4f (\PYZpc{}.4f)\PYZdq{} \PYZpc{} (sigma2, err\PYZus{}sigma2) \PYZbs{}}
\PY{c+c1}{\PYZsh{}              + \PYZdq{}\PYZbs{}n N = \PYZpc{}.2f (\PYZpc{}.2f)\PYZdq{} \PYZpc{} (N, err\PYZus{}N))}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,}\PY{n}{yy}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gaussian fit: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PYZbs{}
        \PY{o}{+} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sigma\PYZca{}2\PYZdl{} = }\PY{l+s+si}{\PYZpc{}.4f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sigma2}\PY{p}{)} \PYZbs{}
         \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{ N = }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{N}\PY{p}{)}\PY{p}{)}
    
    \PY{n}{plt}\PY{o}{.}\PY{n}{minorticks\PYZus{}on}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lag time: \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau=\PYZdl{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{ days}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{tau}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{y\PYZus{}max}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{fontsize} \PY{o}{=} \PY{l+m+mi}{9}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{68}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} n\PYZus{}delta\PYZus{}init = 4 \PYZsh{} later, can increase this}
\PY{c+c1}{\PYZsh{} logdelta\PYZus{}min = np.log10(365*2)}
\PY{c+c1}{\PYZsh{} logdelta\PYZus{}max = np.log10(1500)}
\PY{c+c1}{\PYZsh{} delta\PYZus{}vals = np.unique(np.floor(np.logspace(logdelta\PYZus{}min, logdelta\PYZus{}max, n\PYZus{}delta\PYZus{}init))).astype(int)}
\PY{c+c1}{\PYZsh{} delta\PYZus{}vals}
\end{Verbatim}
\end{tcolorbox}

    \subsection{{[}PDF-NTL{]}}\label{pdf-ntl}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tau\PYZus{}vals\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{,} \PY{l+m+mi}{90}\PY{p}{,} \PY{l+m+mi}{365}\PY{p}{,} \PY{l+m+mi}{730}\PY{p}{,}  \PY{l+m+mi}{928}\PY{p}{,} \PY{l+m+mi}{1179}\PY{p}{,} \PY{l+m+mi}{1500}\PY{p}{]}\PY{p}{)}


\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plot\PYZus{}PDF\PYZus{}BM\PYZus{}STL}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NTL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{xlimit} \PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{,} \PY{n}{n\PYZus{}bins} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{,} \PY{n}{y\PYZus{}max} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Spectral}\PY{p}{(}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{14}\PY{p}{)}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_100_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{{[}PDF-Trend{]}}\label{pdf-trend}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{70}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plot\PYZus{}PDF\PYZus{}BM\PYZus{}STL}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Trend}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{xlimit} \PY{o}{=} \PY{l+m+mf}{0.25}\PY{p}{,} \PY{n}{n\PYZus{}bins} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{,} \PY{n}{y\PYZus{}max} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{,}  \PY{n}{c} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Spectral}\PY{p}{(}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{14}\PY{p}{)}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_102_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{{[}PDF-Seasonality{]}}\label{pdf-seasonality}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{71}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plot\PYZus{}PDF\PYZus{}BM\PYZus{}STL}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Seasonality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{xlimit} \PY{o}{=} \PY{l+m+mf}{0.25}\PY{p}{,} \PY{n}{n\PYZus{}bins} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{,} \PY{n}{y\PYZus{}max} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Spectral}\PY{p}{(}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{14}\PY{p}{)}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_104_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{{[}PDF-Residual{]}}\label{pdf-residual}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{72}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tau} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{tau\PYZus{}vals\PYZus{}1}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plot\PYZus{}PDF\PYZus{}BM\PYZus{}STL}\PY{p}{(}\PY{n}{NTL\PYZus{}DF}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Residual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{tau}\PY{p}{,} \PY{n}{xlimit} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{n\PYZus{}bins} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{,} \PY{n}{y\PYZus{}max} \PY{o}{=} \PY{l+m+mi}{8}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Spectral}\PY{p}{(}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{14}\PY{p}{)}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{bottom}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{73}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{show\PYZus{}markers}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{365}\PY{p}{:} \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{year}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{)}
    \PY{k}{for} \PY{n}{week} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{7}\PY{p}{:} \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{week}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{)}

\PY{c+c1}{\PYZsh{}     plt.axvline(1, ls=\PYZsq{}\PYZhy{}\PYZsq{}, color = \PYZsq{}g\PYZsq{}, lw = 2)}
\PY{c+c1}{\PYZsh{}     for year in np.arange(1,11)*365: plt.axvline(year, ls=\PYZsq{}:\PYZsq{}, color = \PYZsq{}b\PYZsq{}, lw = 2, alpha = 0.5)}
\PY{c+c1}{\PYZsh{}     plt.axvline(365, ls=\PYZsq{}\PYZhy{}\PYZsq{}, color = \PYZsq{}b\PYZsq{}, lw = 2)}
\end{Verbatim}
\end{tcolorbox}

    \subsection{MSD of Trend and
Seasonality}\label{msd-of-trend-and-seasonality}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{loc} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Plotting MSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{ncol} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                \PY{n}{bbox\PYZus{}transform}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transAxes}\PY{p}{,} \PY{n}{fancybox} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSD of NTL Trends}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
    
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{MSD\PYZus{}seasonality\PYZus{}df}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{ncol} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                \PY{n}{bbox\PYZus{}transform}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transAxes}\PY{p}{,} \PY{n}{fancybox} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSD of NTL Seasonality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Plotting MSD: 15it [00:00, 144.83it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_109_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{loc} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{,} \PY{n}{desc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Plotting MSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     show\PYZus{}markers()}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{ncol} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                \PY{n}{bbox\PYZus{}transform}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transAxes}\PY{p}{,} \PY{n}{fancybox} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSD of NTL Trends}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
    
    
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{MSD\PYZus{}seasonality\PYZus{}df}\PY{p}{[}\PY{n}{loc}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{n}{loc}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{gnuplot2}\PY{p}{(}\PY{n}{i}\PY{o}{/}\PY{l+m+mi}{17}\PY{p}{)}\PY{p}{,} \PY{n}{ms} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{marker}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{ncol} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                \PY{n}{bbox\PYZus{}transform}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transAxes}\PY{p}{,} \PY{n}{fancybox} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSD of NTL Seasonality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Plotting MSD: 15it [00:00, 170.26it/s]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_110_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{253}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSD\PYZus{}trend\PYZus{}df}
\PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../MSD\PYZus{}trends.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{MSD\PYZus{}seasonality\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../MSD\PYZus{}seasonality.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \section{Theoretical MSD fits}\label{theoretical-msd-fits}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{empirical\PYZus{}MSD} \PY{o}{=} \PY{n}{MSD\PYZus{}trend\PYZus{}df}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{empirical\PYZus{}MSD} \PY{o}{=} \PY{n}{empirical\PYZus{}MSD}\PY{p}{[}\PY{n}{empirical\PYZus{}MSD}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAR}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{empirical\PYZus{}MSD}

\PY{c+c1}{\PYZsh{} empirical\PYZus{}MSD = MSD\PYZus{}seasonality\PYZus{}df.dropna(how=\PYZsq{}all\PYZsq{})}
\PY{c+c1}{\PYZsh{} empirical\PYZus{}MSD = empirical\PYZus{}MSD[empirical\PYZus{}MSD[\PYZsq{}NCR\PYZsq{}] != 0]}
\PY{c+c1}{\PYZsh{} empirical\PYZus{}MSD}

\PY{c+c1}{\PYZsh{} empirical\PYZus{}MSD.to\PYZus{}csv(\PYZsq{}BM\PYZus{}MSD.csv\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.plot(empirical\PYZus{}MSD)}
\PY{c+c1}{\PYZsh{} plt.xscale(\PYZdq{}log\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.yscale(\PYZdq{}log\PYZdq{})}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
        Region XII     Region VI     Region II          ARMM  Region IV-A  \textbackslash{}
1     1.373686e-07  2.505249e-07  2.093314e-07  1.040961e-07     0.000001
2     2.627491e-07  4.790581e-07  4.009673e-07  2.027842e-07     0.000002
3     4.196534e-07  7.651666e-07  6.370537e-07  3.279231e-07     0.000004
4     6.126077e-07  1.122890e-06  9.189755e-07  4.820801e-07     0.000005
5     8.435738e-07  1.553360e-06  1.247377e-06  6.655336e-07     0.000008
{\ldots}            {\ldots}           {\ldots}           {\ldots}           {\ldots}          {\ldots}
3267  1.079690e-04  2.488644e-04  1.539422e-05  6.571028e-06     0.005624
3268  8.736536e-05  2.010283e-04  1.259257e-05  5.436980e-06     0.004525
3269  6.617442e-05  1.521126e-04  9.708738e-06  4.208502e-06     0.003413
3270  4.468065e-05  1.024471e-04  6.645020e-06  2.913456e-06     0.002287
3271  2.260453e-05  5.169894e-05  3.403970e-06  1.504350e-06     0.001149

          Region I     Region XI     Region IX    Region III       NCR  \textbackslash{}
1     4.324803e-07  1.769625e-07  1.184099e-07  6.713778e-07  0.000282
2     8.112249e-07  3.514803e-07  2.272876e-07  1.301591e-06  0.000561
3     1.275303e-06  5.782119e-07  3.664550e-07  2.102756e-06  0.000928
4     1.846937e-06  8.608872e-07  5.372340e-07  3.129208e-06  0.001392
5     2.537192e-06  1.200152e-06  7.401565e-07  4.399730e-06  0.001960
{\ldots}            {\ldots}           {\ldots}           {\ldots}           {\ldots}       {\ldots}
3267  4.423399e-04  1.920896e-04  9.106118e-06  3.011999e-03  0.635107
3268  3.551725e-04  1.554606e-04  7.492257e-06  2.422774e-03  0.510415
3269  2.677978e-04  1.178527e-04  5.763403e-06  1.827007e-03  0.384281
3270  1.795655e-04  7.953019e-05  3.972114e-06  1.223898e-03  0.257467
3271  9.022880e-05  4.025614e-05  2.051881e-06  6.142613e-04  0.129274

       Region XIII    Region VII   Region VIII      Region X           CAR
1     1.412047e-07  3.264075e-07  2.029684e-07  1.356483e-07  1.833834e-07
2     2.653071e-07  6.348276e-07  3.796273e-07  2.605023e-07  3.456291e-07
3     4.221885e-07  1.028450e-06  5.974963e-07  4.200763e-07  5.474923e-07
4     6.134459e-07  1.524209e-06  8.631643e-07  6.198094e-07  7.914536e-07
5     8.396346e-07  2.122872e-06  1.175613e-06  8.617042e-07  1.079199e-06
{\ldots}            {\ldots}           {\ldots}           {\ldots}           {\ldots}           {\ldots}
3267  3.932382e-06  4.476448e-04  3.931128e-09  1.747790e-05  8.330003e-07
3268  3.307107e-06  3.620286e-04  6.253714e-09  1.434117e-05  6.439801e-07
3269  2.606749e-06  2.744170e-04  9.431302e-09  1.102199e-05  4.564845e-07
3270  1.819374e-06  1.853105e-04  1.307318e-08  7.549984e-06  2.838738e-07
3271  9.502900e-07  9.376893e-05  1.046466e-08  3.866106e-06  1.313543e-07

[3271 rows x 15 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{185}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{msd\PYZus{}emp} \PY{o}{=} \PY{n}{empirical\PYZus{}MSD}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NCR}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
\PY{n}{delta\PYZus{}vals\PYZus{}emp} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{msd\PYZus{}emp}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{N\PYZus{}i}\PY{p}{,} \PY{n}{N} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1000}
\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{n}{N\PYZus{}i}\PY{p}{:}\PY{n}{N}\PY{p}{]}\PY{p}{,} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{n}{N\PYZus{}i}\PY{p}{:}\PY{n}{N}\PY{p}{]}

\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bo\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} plt.plot(delta\PYZus{}vals\PYZus{}emp, msd\PYZus{}emp, \PYZsq{}b.\PYZhy{}\PYZsq{}, alpha=0.5, lw=3, label=\PYZdq{}empirical MSD\PYZdq{})}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{185}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.lines.Line2D at 0x7feb3ab23b50>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_114_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{186}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
    
\PY{k}{def} \PY{n+nf}{plot\PYZus{}labels}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{187}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{plot\PYZus{}MSD\PYZus{}fits}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{n}{xx}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{)}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{150}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theoretical MSD\PYZhy{}fit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plot\PYZus{}labels}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theoretical MSD\PYZhy{}fit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}
    \PY{n}{plot\PYZus{}labels}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsection{1-MSD = A · exp(Γ(𝑇)) ·
𝑐𝑜𝑠(𝜔·𝑇·𝜙)}\label{msd-a-expux3b3ux1d447-ux1d450ux1d45cux1d460ux1d714ux1d447ux1d719}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{188}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{fit\PYZus{}MSD}\PY{p}{(}\PY{n}{N\PYZus{}data}\PY{p}{)}\PY{p}{:}
    \PY{n}{N\PYZus{}i}\PY{p}{,} \PY{n}{N} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{N\PYZus{}data}
    \PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{n}{N\PYZus{}i}\PY{p}{:}\PY{n}{N}\PY{p}{]}\PY{p}{,} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{n}{N\PYZus{}i}\PY{p}{:}\PY{n}{N}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} Define the fitting function with gamma and cosine terms}
    \PY{k}{def} \PY{n+nf}{fitting\PYZus{}function}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{A}\PY{p}{,} \PY{n}{omega}\PY{p}{,} \PY{n}{phi}\PY{p}{,} \PY{n}{C}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{A} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{*} \PY{n}{x}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega} \PY{o}{*} \PY{n}{x} \PY{o}{+} \PY{n}{phi}\PY{p}{)} \PY{o}{+} \PY{n}{C}

    \PY{c+c1}{\PYZsh{} Initial guess for the parameters}
    \PY{n}{initial\PYZus{}guess} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}  \PY{c+c1}{\PYZsh{} Adjust these values based on your expectation}

    \PY{c+c1}{\PYZsh{} Fit the curve to the data}
    \PY{n}{params}\PY{p}{,} \PY{n}{covariance} \PY{o}{=} \PY{n}{curve\PYZus{}fit}\PY{p}{(}\PY{n}{fitting\PYZus{}function}\PY{p}{,} \PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{n}{p0}\PY{o}{=}\PY{n}{initial\PYZus{}guess}\PY{p}{,} \PY{n}{maxfev}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Extracting the fitted parameters}
    \PY{n}{gamma\PYZus{}fit}\PY{p}{,} \PY{n}{A\PYZus{}fit}\PY{p}{,} \PY{n}{omega\PYZus{}fit}\PY{p}{,} \PY{n}{phi\PYZus{}fit}\PY{p}{,} \PY{n}{C\PYZus{}fit} \PY{o}{=} \PY{n}{params}

    \PY{c+c1}{\PYZsh{} Generate fitted curve using the fitted parameters}
    \PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{fitting\PYZus{}function}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{gamma\PYZus{}fit}\PY{p}{,} \PY{n}{A\PYZus{}fit}\PY{p}{,} \PY{n}{omega\PYZus{}fit}\PY{p}{,} \PY{n}{phi\PYZus{}fit}\PY{p}{,} \PY{n}{C\PYZus{}fit}\PY{p}{)}

    \PY{n}{plot\PYZus{}MSD\PYZus{}fits}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{Gamma\PYZdl{} = }\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s2}{, A = }\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s2}{, \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{omega\PYZdl{} = }\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s2}{, \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{phi\PYZdl{} = }\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s2}{, C = }\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s2}{\PYZdq{}} \PYZbs{}
          \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{gamma\PYZus{}fit}\PY{p}{,} \PY{n}{A\PYZus{}fit}\PY{p}{,} \PY{n}{omega\PYZus{}fit}\PY{p}{,} \PY{n}{phi\PYZus{}fit}\PY{p}{,} \PY{n}{C\PYZus{}fit}\PY{p}{)}\PY{p}{,} \PY{n}{fontsize} \PY{o}{=} \PY{l+m+mi}{12}\PY{p}{)}

    
\PY{n}{fit\PYZus{}MSD}\PY{p}{(}\PY{l+m+mi}{800}\PY{p}{)}
\PY{c+c1}{\PYZsh{} for N in np.arange(600,1400,200): fit\PYZus{}MSD(N)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_118_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{\texorpdfstring{2-MSD =
\(\frac{𝑁⋅𝑇^{2⋅𝐻})}{(2⋅𝐻⋅[Γ(𝐻+1/2)]^2}\)}{2-MSD = \textbackslash frac\{𝑁⋅𝑇\^{}\{2⋅𝐻\})\}\{(2⋅𝐻⋅{[}Γ(𝐻+1/2){]}\^{}2\}}}\label{msd-fracux1d441ux1d4472ux1d43b2ux1d43bux3b3ux1d43b122}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{184}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{fit\PYZus{}MSD}\PY{p}{(}\PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{)}\PY{p}{:}
    
    \PY{k}{def} \PY{n+nf}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{H}\PY{p}{,} \PY{n}{N}\PY{p}{)}\PY{p}{:}
        \PY{n}{gamma\PYZus{}term} \PY{o}{=} \PY{n}{gamma}\PY{p}{(}\PY{n}{H}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{n}{denom} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{H}\PY{o}{*}\PY{n}{gamma\PYZus{}term}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
        \PY{k}{return} \PY{n}{N}\PY{o}{*}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{H}\PY{p}{)}\PY{o}{/}\PY{n}{denom}

    \PY{c+c1}{\PYZsh{} set range of fitting regime}
    \PY{n}{tau\PYZus{}fit\PYZus{}min} \PY{o}{=} \PY{l+m+mi}{1}

    \PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{n}{tau\PYZus{}fit\PYZus{}min}\PY{p}{:}\PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{]}\PY{p}{,} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{n}{tau\PYZus{}fit\PYZus{}min}\PY{p}{:}\PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{]}


    \PY{c+c1}{\PYZsh{} set initial values for H, N}
    \PY{n}{initial\PYZus{}ss} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}
    \PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{)}
    \PY{n}{i\PYZus{}fit} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{[}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{tau\PYZus{}fit\PYZus{}min}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp} \PY{o}{\PYZlt{}} \PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{)}\PY{p}{]}
    \PY{c+c1}{\PYZsh{} i\PYZus{}fit}
    \PY{n}{x\PYZus{}fit} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{n}{i\PYZus{}fit}\PY{p}{]}
    \PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{n}{i\PYZus{}fit}\PY{p}{]}
    \PY{n}{n\PYZus{}fit} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{i\PYZus{}fit}\PY{p}{)}
    \PY{n}{popt}\PY{p}{,} \PY{n}{pcov} \PY{o}{=} \PY{n}{curve\PYZus{}fit}\PY{p}{(}\PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{,} \PY{n}{x\PYZus{}fit}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{n}{initial\PYZus{}ss}\PY{p}{,} \PY{n}{maxfev}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}

    \PY{n}{fit\PYZus{}H}\PY{p}{,} \PY{n}{fit\PYZus{}N} \PY{o}{=} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{err\PYZus{}H}\PY{p}{,} \PY{n}{err\PYZus{}N} \PY{o}{=} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}

    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{H = }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{), N = }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{fit\PYZus{}H}\PY{p}{,} \PY{n}{err\PYZus{}H}\PY{p}{,} \PY{n}{fit\PYZus{}N}\PY{p}{,} \PY{n}{err\PYZus{}N}\PY{p}{)}\PY{p}{)}

    \PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{fit\PYZus{}H}\PY{p}{,} \PY{n}{fit\PYZus{}N}\PY{p}{)}
    
    \PY{n}{plot\PYZus{}MSD\PYZus{}fits}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{H = }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{, N = }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{fit\PYZus{}H}\PY{p}{,} \PY{n}{fit\PYZus{}N}\PY{p}{)}\PY{p}{)}

\PY{n}{fit\PYZus{}MSD}\PY{p}{(}\PY{l+m+mi}{200}\PY{p}{)}
\PY{c+c1}{\PYZsh{} for N in np.arange(100, 1000, 100): fit\PYZus{}MSD(N)}
\PY{c+c1}{\PYZsh{} for N in np.arange(50, 250, 50): fit\PYZus{}MSD(N)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
H = 0.80261 (0.00273), N = 0.00032 (0.00001)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_120_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{111}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} def plot\PYZus{}MSD\PYZus{}fits(x\PYZus{}samp, y\PYZus{}samp, y\PYZus{}fit):}
\PY{c+c1}{\PYZsh{}     plt.figure(figsize = (10,3), dpi = 150)}
\PY{c+c1}{\PYZsh{}     plt.subplot(121)}
\PY{c+c1}{\PYZsh{} \PYZsh{}     plt.grid(alpha = 0.5)}
\PY{c+c1}{\PYZsh{} \PYZsh{}     plt.plot(x\PYZus{}samp, y\PYZus{}samp, \PYZsq{}b.\PYZhy{}\PYZsq{}, alpha=0.2, lw=3, label=\PYZdq{}empirical MSD\PYZdq{})}
\PY{c+c1}{\PYZsh{} \PYZsh{}     plt.plot(x\PYZus{}samp, y\PYZus{}fit, \PYZsq{}r\PYZhy{}\PYZhy{}\PYZsq{}, label = \PYZsq{}theoretical MSD\PYZhy{}fit\PYZsq{})}
\PY{c+c1}{\PYZsh{} \PYZsh{}     plt.xlabel(r\PYZdq{}\PYZdl{}\PYZbs{}tau\PYZdl{}\PYZdq{})}
\PY{c+c1}{\PYZsh{} \PYZsh{}     plt.ylabel(\PYZdq{}MSD\PYZdq{})}
\PY{c+c1}{\PYZsh{} \PYZsh{}     plt.legend()}
\PY{c+c1}{\PYZsh{}     plt.plot(x\PYZus{}samp, y\PYZus{}samp, \PYZsq{}b.\PYZhy{}\PYZsq{}, alpha=0.2, lw=3, label=\PYZdq{}empirical MSD\PYZdq{})}
\PY{c+c1}{\PYZsh{}     plot\PYZus{}in\PYZus{}log()}

\PY{c+c1}{\PYZsh{}     plt.subplot(122)}
\PY{c+c1}{\PYZsh{}     plt.grid(alpha = 0.5)}
\PY{c+c1}{\PYZsh{} \PYZsh{}     plt.plot(x\PYZus{}samp, y\PYZus{}samp, \PYZsq{}b.\PYZhy{}\PYZsq{}, alpha=0.2, lw=3, label=\PYZdq{}empirical MSD\PYZdq{})}
\PY{c+c1}{\PYZsh{}     plt.plot(x, y\PYZus{}fit, \PYZsq{}r\PYZhy{}\PYZhy{}\PYZsq{}, label = \PYZsq{}theoretical MSD\PYZhy{}fit\PYZsq{})}
\PY{c+c1}{\PYZsh{}     plt.xlabel(r\PYZdq{}\PYZdl{}\PYZbs{}tau\PYZdl{}\PYZdq{})}
\PY{c+c1}{\PYZsh{}     plt.ylabel(\PYZdq{}MSD\PYZdq{})}
\PY{c+c1}{\PYZsh{}     plot\PYZus{}in\PYZus{}log()}
\end{Verbatim}
\end{tcolorbox}

    \subsection{\texorpdfstring{3-MSD =
\(\frac{Γ(𝜇)⋅cos⁡(𝑣𝑇/2)⋅𝐽_{𝜇−1/2}(𝑣𝑇/2)}{𝜋^{−1/2} ⋅ 𝑇^{1/2 −𝜇}⋅𝑣^{𝜇−1/2}}\)}{3-MSD = \textbackslash frac\{Γ(𝜇)⋅cos⁡(𝑣𝑇/2)⋅𝐽\_\{𝜇−1/2\}(𝑣𝑇/2)\}\{𝜋\^{}\{−1/2\} ⋅ 𝑇\^{}\{1/2 −𝜇\}⋅𝑣\^{}\{𝜇−1/2\}\}}}\label{msd-fracux3b3ux1d707cosux1d463ux1d4472ux1d43d_ux1d70712ux1d463ux1d4472ux1d70b12-ux1d44712-ux1d707ux1d463ux1d70712}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{113}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{special} \PY{k+kn}{import} \PY{n}{gamma}\PY{p}{,} \PY{n}{jv}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{229}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} def fit\PYZus{}MSD(tau\PYZus{}fit\PYZus{}max):}
    
\PY{c+c1}{\PYZsh{}     def msd\PYZus{}theo\PYZus{}ss(T,v,mu,Norm):}
\PY{c+c1}{\PYZsh{}         num = gamma(mu)*np.cos((v*T)/2)*jv(mu\PYZhy{}0.5,(v*T)/2)}
\PY{c+c1}{\PYZsh{}         denom = np.pi**(\PYZhy{}0.5) * T**(0.5\PYZhy{}mu) * v**(mu\PYZhy{}0.5)*Norm}
\PY{c+c1}{\PYZsh{}         return num/denom}

\PY{c+c1}{\PYZsh{}     \PYZsh{} set range of fitting regime}
\PY{c+c1}{\PYZsh{}     tau\PYZus{}fit\PYZus{}min = 1}

\PY{c+c1}{\PYZsh{}     x\PYZus{}samp, y\PYZus{}samp = delta\PYZus{}vals\PYZus{}emp[tau\PYZus{}fit\PYZus{}min:tau\PYZus{}fit\PYZus{}max], msd\PYZus{}emp[tau\PYZus{}fit\PYZus{}min:tau\PYZus{}fit\PYZus{}max]}

\PY{c+c1}{\PYZsh{}     \PYZsh{} set initial values for v, mu, Norm}
\PY{c+c1}{\PYZsh{}     initial\PYZus{}ss = [0.001, 2.46, 10**10]}
\PY{c+c1}{\PYZsh{} \PYZsh{}     initial\PYZus{}ss = [1, 1, 10**10]}
\PY{c+c1}{\PYZsh{}     n\PYZus{}tau = len(delta\PYZus{}vals\PYZus{}emp)}
\PY{c+c1}{\PYZsh{}     i\PYZus{}fit = np.arange(n\PYZus{}tau)[(delta\PYZus{}vals\PYZus{}emp \PYZgt{}= tau\PYZus{}fit\PYZus{}min) \PYZam{} (delta\PYZus{}vals\PYZus{}emp \PYZlt{} tau\PYZus{}fit\PYZus{}max)]}
\PY{c+c1}{\PYZsh{}     \PYZsh{} i\PYZus{}fit}
\PY{c+c1}{\PYZsh{}     x\PYZus{}fit = delta\PYZus{}vals\PYZus{}emp[i\PYZus{}fit]}
\PY{c+c1}{\PYZsh{}     y\PYZus{}fit = msd\PYZus{}emp[i\PYZus{}fit]}
\PY{c+c1}{\PYZsh{}     n\PYZus{}fit = len(i\PYZus{}fit)}
\PY{c+c1}{\PYZsh{}     popt, pcov = curve\PYZus{}fit(msd\PYZus{}theo\PYZus{}ss, x\PYZus{}fit, y\PYZus{}fit, initial\PYZus{}ss, maxfev=50000)}

\PY{c+c1}{\PYZsh{}     fit\PYZus{}v, fit\PYZus{}mu, fit\PYZus{}Norm = popt[0], popt[1], popt[2]}
\PY{c+c1}{\PYZsh{}     err\PYZus{}v, err\PYZus{}mu, err\PYZus{}Norm = pcov[0,0]**0.5, pcov[1,1]**0.5,  pcov[2,2]**0.5}


\PY{c+c1}{\PYZsh{}     print(\PYZdq{}v = \PYZpc{}.5f (\PYZpc{}.5f), mu = \PYZpc{}.5f (\PYZpc{}.5f), Norm = \PYZpc{}.2e (\PYZpc{}.2e)\PYZdq{} \PYZpc{} \PYZbs{}}
\PY{c+c1}{\PYZsh{}           (fit\PYZus{}v, err\PYZus{}v, fit\PYZus{}mu, err\PYZus{}mu, fit\PYZus{}Norm, err\PYZus{}Norm))}

\PY{c+c1}{\PYZsh{}     xx = np.logspace(np.log(1e\PYZhy{}1), np.log(1e2), tau\PYZus{}fit\PYZus{}max\PYZhy{}1)}

\PY{c+c1}{\PYZsh{}     y\PYZus{}fit = msd\PYZus{}theo\PYZus{}ss(xx, fit\PYZus{}v, fit\PYZus{}mu, fit\PYZus{}Norm)}
    
\PY{c+c1}{\PYZsh{}     N\PYZus{}factor = (max(y\PYZus{}samp)\PYZhy{}min(y\PYZus{}samp))/(max(y\PYZus{}fit)\PYZhy{}min(y\PYZus{}fit))}
\PY{c+c1}{\PYZsh{}     emp\PYZus{}peak = y\PYZus{}samp.tolist().index(max(y\PYZus{}samp))}
\PY{c+c1}{\PYZsh{}     theo\PYZus{}peak = y\PYZus{}fit.tolist().index(max(y\PYZus{}fit))}
\PY{c+c1}{\PYZsh{}     tc = x\PYZus{}samp[emp\PYZus{}peak]/xx[theo\PYZus{}peak]}

\PY{c+c1}{\PYZsh{}     plot\PYZus{}MSD\PYZus{}fits(x\PYZus{}samp, y\PYZus{}samp, xx*tc, N\PYZus{}factor*y\PYZus{}fit)}
    
\PY{c+c1}{\PYZsh{}     plt.suptitle(\PYZdq{}v = \PYZpc{}.3f, mu = \PYZpc{}.3f, Norm = \PYZpc{}2e\PYZdq{} \PYZpc{} (fit\PYZus{}v, fit\PYZus{}mu, fit\PYZus{}Norm))}
    
\PY{c+c1}{\PYZsh{} \PYZsh{} fit\PYZus{}MSD(1000)}
\PY{c+c1}{\PYZsh{} for N in np.arange(500, 2500, 500): fit\PYZus{}MSD(N)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{254}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{fit\PYZus{}MSD}\PY{p}{(}\PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{)}\PY{p}{:}
    
    \PY{k}{def} \PY{n+nf}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{v}\PY{p}{,}\PY{n}{mu}\PY{p}{)}\PY{p}{:}
        \PY{n}{num} \PY{o}{=} \PY{n}{gamma}\PY{p}{(}\PY{n}{mu}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{p}{(}\PY{n}{v}\PY{o}{*}\PY{n}{T}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{jv}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{(}\PY{n}{v}\PY{o}{*}\PY{n}{T}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{denom} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)} \PY{o}{*} \PY{n}{T}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{o}{\PYZhy{}}\PY{n}{mu}\PY{p}{)} \PY{o}{*} \PY{n}{v}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{mu}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{k}{return} \PY{n}{num}\PY{o}{/}\PY{n}{denom}

    \PY{c+c1}{\PYZsh{} set range of fitting regime}
    \PY{n}{tau\PYZus{}fit\PYZus{}min} \PY{o}{=} \PY{l+m+mi}{1}

    \PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{n}{tau\PYZus{}fit\PYZus{}min}\PY{p}{:}\PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{]}\PY{p}{,} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{n}{tau\PYZus{}fit\PYZus{}min}\PY{p}{:}\PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} set initial values for v, mu, Norm}
\PY{c+c1}{\PYZsh{}     initial\PYZus{}ss = [0.001, 2.46]}
    \PY{n}{initial\PYZus{}ss} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{c+c1}{\PYZsh{}     initial\PYZus{}ss = [0.1, 2.46]}

    \PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{)}
    \PY{n}{i\PYZus{}fit} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{[}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{tau\PYZus{}fit\PYZus{}min}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp} \PY{o}{\PYZlt{}} \PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{)}\PY{p}{]}
    \PY{c+c1}{\PYZsh{} i\PYZus{}fit}
    \PY{n}{x\PYZus{}fit} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{n}{i\PYZus{}fit}\PY{p}{]}
    \PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{n}{i\PYZus{}fit}\PY{p}{]}
    \PY{n}{n\PYZus{}fit} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{i\PYZus{}fit}\PY{p}{)}
    \PY{n}{popt}\PY{p}{,} \PY{n}{pcov} \PY{o}{=} \PY{n}{curve\PYZus{}fit}\PY{p}{(}\PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{,} \PY{n}{x\PYZus{}fit}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{n}{initial\PYZus{}ss}\PY{p}{,} \PY{n}{maxfev}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}

    \PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu} \PY{o}{=} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{err\PYZus{}v}\PY{p}{,} \PY{n}{err\PYZus{}mu} \PY{o}{=} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}


    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v = }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{), mu = }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PYZbs{}
          \PY{p}{(}\PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{err\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu}\PY{p}{,} \PY{n}{err\PYZus{}mu}\PY{p}{)}\PY{p}{)}

    \PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}2}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e2}\PY{p}{)}\PY{p}{,} \PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{}     y\PYZus{}fit = msd\PYZus{}theo\PYZus{}ss(x\PYZus{}samp, fit\PYZus{}v, fit\PYZus{}mu)}
    \PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu}\PY{p}{)}
    
\PY{c+c1}{\PYZsh{}     N\PYZus{}factor = (max(y\PYZus{}samp)\PYZhy{}min(y\PYZus{}samp))/(max(y\PYZus{}fit)\PYZhy{}min(y\PYZus{}fit))}
\PY{c+c1}{\PYZsh{}     emp\PYZus{}peak = y\PYZus{}samp.tolist().index(max(y\PYZus{}samp))}
\PY{c+c1}{\PYZsh{}     theo\PYZus{}peak = y\PYZus{}fit.tolist().index(max(y\PYZus{}fit))}
\PY{c+c1}{\PYZsh{}     tc = x\PYZus{}samp[emp\PYZus{}peak]/xx[theo\PYZus{}peak]}

\PY{c+c1}{\PYZsh{}     plot\PYZus{}MSD\PYZus{}fits(x\PYZus{}samp, y\PYZus{}samp, xx*tc, N\PYZus{}factor*y\PYZus{}fit)}
\PY{c+c1}{\PYZsh{}     plot\PYZus{}MSD\PYZus{}fits(x\PYZus{}samp, y\PYZus{}samp, x\PYZus{}samp, y\PYZus{}fit)}
    \PY{n}{plot\PYZus{}MSD\PYZus{}fits}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{n}{xx}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v = }\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s2}{, mu = }\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu}\PY{p}{)}\PY{p}{)}
    
\PY{c+c1}{\PYZsh{} fit\PYZus{}MSD(1000)}
\PY{k}{for} \PY{n}{N} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,} \PY{l+m+mi}{1500}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}\PY{p}{:} \PY{n}{fit\PYZus{}MSD}\PY{p}{(}\PY{n}{N}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
v = 0.55361 (0.03851), mu = -0.14578 (0.08098)
v = 0.65996 (0.04240), mu = -0.15067 (0.09017)
v = 0.63699 (0.03125), mu = -0.12462 (0.06586)
v = 0.52556 (0.01865), mu = -0.09039 (0.03815)
v = 0.34847 (0.00898), mu = -0.05495 (0.01697)
v = 0.21932 (0.00453), mu = -0.03330 (0.00767)
v = 0.21651 (0.00403), mu = -0.03175 (0.00690)
v = 0.34510 (0.00647), mu = -0.04861 (0.01281)
v = 0.53129 (0.01086), mu = -0.07369 (0.02413)
v = 0.69536 (0.01576), mu = -0.09624 (0.03727)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_125_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{216}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}1}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e2}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mf}{0.011}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mf}{2.169}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{v = 2, mu = 5}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_126_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{124}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{v}\PY{p}{,}\PY{n}{mu}\PY{p}{)}\PY{p}{:}
    \PY{n}{num} \PY{o}{=} \PY{n}{gamma}\PY{p}{(}\PY{n}{mu}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{p}{(}\PY{n}{v}\PY{o}{*}\PY{n}{T}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{jv}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{(}\PY{n}{v}\PY{o}{*}\PY{n}{T}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{denom} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)} \PY{o}{*} \PY{n}{T}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{o}{\PYZhy{}}\PY{n}{mu}\PY{p}{)} \PY{o}{*} \PY{n}{v}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{mu}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v = }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{, \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mu\PYZdl{} = }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{v}\PY{p}{,} \PY{n}{mu}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{num}\PY{o}{/}\PY{n}{denom}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{150}\PY{p}{)}

\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{l+m+mf}{0.001}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{131}\PY{p}{)}
\PY{n}{GBR} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mf}{0.99}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mf}{4.64}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{GBR}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GBR}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}

\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{l+m+mi}{80}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{132}\PY{p}{)}
\PY{n}{CO2} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mf}{0.07}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mf}{1.25}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{CO2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CO2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}

\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{133}\PY{p}{)}
\PY{n}{SST} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mf}{0.19}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mf}{1.18}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{SST}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SST}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} plot\PYZus{}MSD\PYZus{}fits(xx, y\PYZus{}fit, y\PYZus{}fit)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_127_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{125}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{v}\PY{p}{,}\PY{n}{mu}\PY{p}{)}\PY{p}{:}
    \PY{n}{num} \PY{o}{=} \PY{n}{gamma}\PY{p}{(}\PY{n}{mu}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{p}{(}\PY{n}{v}\PY{o}{*}\PY{n}{T}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{jv}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{(}\PY{n}{v}\PY{o}{*}\PY{n}{T}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{denom} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)} \PY{o}{*} \PY{n}{T}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{o}{\PYZhy{}}\PY{n}{mu}\PY{p}{)} \PY{o}{*} \PY{n}{v}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{mu}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{k}{return} \PY{n}{num}\PY{o}{/}\PY{n}{denom}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{126}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}5}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e2}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{193}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{193}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.lines.Line2D at 0x7feb0925d190>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_130_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{156}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{150}\PY{p}{)}
\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}5}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e2}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{v = 1, mu = 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}1}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e2}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{v = 2, mu = 5}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}


\PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}6}\PY{p}{,}\PY{l+m+mf}{1e5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}5}\PY{p}{,}\PY{l+m+mf}{1e2}\PY{p}{)}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_131_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{157}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{N\PYZus{}i}\PY{p}{,} \PY{n}{N} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1000}
\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{n}{N\PYZus{}i}\PY{p}{:}\PY{n}{N}\PY{p}{]}\PY{p}{,} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{n}{N\PYZus{}i}\PY{p}{:}\PY{n}{N}\PY{p}{]}

\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}1}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1.5}\PY{p}{)}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{y\PYZus{}samp}\PY{p}{)}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
\PY{n}{msd\PYZus{}theo} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{msd\PYZus{}theo}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{v = 1, mu = 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_132_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{N\PYZus{}factor} \PY{o}{=} \PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{y\PYZus{}samp}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n+nb}{min}\PY{p}{(}\PY{n}{y\PYZus{}samp}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{msd\PYZus{}theo}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n+nb}{min}\PY{p}{(}\PY{n}{msd\PYZus{}theo}\PY{p}{)}\PY{p}{)}
\PY{n}{emp\PYZus{}peak} \PY{o}{=} \PY{n}{y\PYZus{}samp}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{y\PYZus{}samp}\PY{p}{)}\PY{p}{)}
\PY{n}{theo\PYZus{}peak} \PY{o}{=} \PY{n}{msd\PYZus{}theo}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{msd\PYZus{}theo}\PY{p}{)}\PY{p}{)}
\PY{n}{tc} \PY{o}{=} \PY{n}{x\PYZus{}samp}\PY{p}{[}\PY{n}{emp\PYZus{}peak}\PY{p}{]}\PY{o}{/}\PY{n}{xx}\PY{p}{[}\PY{n}{theo\PYZus{}peak}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{158}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{max}\PY{p}{(}\PY{n}{y\PYZus{}samp}\PY{p}{)}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{n}{msd\PYZus{}theo}\PY{p}{)}
\PY{n}{N\PYZus{}factor} \PY{o}{=} \PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{y\PYZus{}samp}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n+nb}{min}\PY{p}{(}\PY{n}{y\PYZus{}samp}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{msd\PYZus{}theo}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n+nb}{min}\PY{p}{(}\PY{n}{msd\PYZus{}theo}\PY{p}{)}\PY{p}{)}
\PY{n}{N\PYZus{}factor}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{158}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
5.673528574159103
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{159}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{emp\PYZus{}peak} \PY{o}{=} \PY{n}{y\PYZus{}samp}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{y\PYZus{}samp}\PY{p}{)}\PY{p}{)}
\PY{n}{theo\PYZus{}peak} \PY{o}{=} \PY{n}{msd\PYZus{}theo}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{msd\PYZus{}theo}\PY{p}{)}\PY{p}{)}
\PY{n}{emp\PYZus{}peak}\PY{p}{,} \PY{n}{theo\PYZus{}peak}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{159}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(549, 950)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{160}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tc} \PY{o}{=} \PY{n}{x\PYZus{}samp}\PY{p}{[}\PY{n}{emp\PYZus{}peak}\PY{p}{]}\PY{o}{/}\PY{n}{xx}\PY{p}{[}\PY{n}{theo\PYZus{}peak}\PY{p}{]}
\PY{n}{tc}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{160}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
293.5789200246248
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{161}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{150}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}1}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1.5}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{v = 1, mu = 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}1}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1.5}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{v = 1, mu = 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{N\PYZus{}factor}\PY{o}{*}\PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N =}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{N\PYZus{}factor}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{o}{*}\PY{n}{tc}\PY{p}{,} \PY{n}{N\PYZus{}factor}\PY{o}{*}\PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N =}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{, tc =}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{N\PYZus{}factor}\PY{p}{,} \PY{n}{tc}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{} plt.plot(xx/0.0001, 2*msd\PYZus{}theo\PYZus{}ss(xx/0.0001, v = 1, mu = 1), \PYZsq{}c.\PYZsq{}, label = \PYZsq{}v = 1, mu = 1\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.plot(xx, msd\PYZus{}theo\PYZus{}ss(xx, v = 1, mu = 1), \PYZsq{}m.\PYZsq{}, label = \PYZsq{}v = 1, mu = 1\PYZsq{})}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_137_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{167}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{150}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}2}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{o}{*}\PY{n}{tc}\PY{p}{,} \PY{n}{N\PYZus{}factor}\PY{o}{*}\PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N =}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{, tc =}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{N\PYZus{}factor}\PY{p}{,} \PY{n}{tc}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{1e3}\PY{p}{)}
\PY{n}{plot\PYZus{}in\PYZus{}log}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_138_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{FPTD (Proof of Concept)}\label{fptd-proof-of-concept}

    \subsection{Using 1-MSD}\label{using-1-msd}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{89}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{A}\PY{p}{,} \PY{n}{omega}\PY{p}{,} \PY{n}{phi}\PY{p}{,} \PY{n}{C}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{n}{A} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{*} \PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega} \PY{o}{*} \PY{n}{t} \PY{o}{+} \PY{n}{phi}\PY{p}{)} \PY{o}{+} \PY{n}{C}
\end{Verbatim}
\end{tcolorbox}

    \subsection{Using 2-MSD}\label{using-2-msd}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{90}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{H}\PY{p}{,} \PY{n}{N}\PY{p}{)}\PY{p}{:}
    \PY{n}{gamma\PYZus{}term} \PY{o}{=} \PY{n}{gamma}\PY{p}{(}\PY{n}{H}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{n}{denom} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{H}\PY{o}{*}\PY{n}{gamma\PYZus{}term}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    \PY{k}{return} \PY{n}{N}\PY{o}{*}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{H}\PY{p}{)}\PY{o}{/}\PY{n}{denom}

\PY{n}{H} \PY{o}{=} \PY{l+m+mf}{0.59523}
\PY{n}{N} \PY{o}{=} \PY{l+m+mf}{0.00244}
\PY{c+c1}{\PYZsh{} err\PYZus{}H = 0.00424}
\PY{n}{err\PYZus{}H} \PY{o}{=} \PY{l+m+mf}{0.25}
\PY{n}{err\PYZus{}N} \PY{o}{=} \PY{l+m+mf}{0.01}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)} \PY{c+c1}{\PYZsh{} equally log\PYZhy{}spaced grid in time, in units of days (previously, tau)}
\PY{n}{m0} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{H}\PY{p}{,} \PY{n}{N}\PY{p}{)}
\PY{n}{m1} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{H}\PY{o}{+}\PY{n}{err\PYZus{}H}\PY{p}{,} \PY{n}{N}\PY{p}{)}
\PY{n}{m2} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{H}\PY{o}{\PYZhy{}}\PY{n}{err\PYZus{}H}\PY{p}{,} \PY{n}{N}\PY{p}{)}


\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m0}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m2}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Varying H: }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{pm\PYZdl{} }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{H}\PY{p}{,} \PY{n}{err\PYZus{}H}\PY{p}{)}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m0}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m2}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Varying H: }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{pm\PYZdl{} }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{H}\PY{p}{,} \PY{n}{err\PYZus{}H}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{90}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Text(0.5, 1.0, 'Varying H: 0.59523 \$\textbackslash{}\textbackslash{}pm\$ 0.25')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_143_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{91}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{err\PYZus{}N} \PY{o}{=} \PY{l+m+mf}{0.001}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)} \PY{c+c1}{\PYZsh{} equally log\PYZhy{}spaced grid in time, in units of days (previously, tau)}
\PY{n}{m0} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{H}\PY{p}{,} \PY{n}{N}\PY{p}{)}
\PY{n}{m1} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{H}\PY{p}{,} \PY{n}{N}\PY{o}{+}\PY{n}{err\PYZus{}N}\PY{p}{)}
\PY{n}{m2} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{H}\PY{p}{,} \PY{n}{N}\PY{o}{\PYZhy{}}\PY{n}{err\PYZus{}N}\PY{p}{)}


\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m0}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m2}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Varying N: }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{pm\PYZdl{} }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{N}\PY{p}{,} \PY{n}{err\PYZus{}N}\PY{p}{)}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m0}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m2}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Varying N: }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{pm\PYZdl{} }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{N}\PY{p}{,} \PY{n}{err\PYZus{}N}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{91}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Text(0.5, 1.0, 'Varying N: 0.00244 \$\textbackslash{}\textbackslash{}pm\$ 0.00')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_144_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{92}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{fptd\PYZus{}fbm}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{dx}\PY{p}{,} \PY{n}{H}\PY{p}{)}\PY{p}{:}
    \PY{n}{c} \PY{o}{=} \PY{n}{H}\PY{o}{*}\PY{n}{gamma}\PY{p}{(}\PY{n}{H}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    \PY{n}{f1} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{H}\PY{o}{*}\PY{p}{(}\PY{n}{c}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{H}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}
    \PY{n}{f2} \PY{o}{=} \PY{n}{dx}
    \PY{n}{f3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{c}\PY{o}{*}\PY{p}{(}\PY{n}{dx}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{/}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{H}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{f1}\PY{o}{*}\PY{n}{f2}\PY{o}{*}\PY{n}{f3}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{93}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} define parameters to use}
\PY{n}{hs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{]}\PY{p}{)}
\PY{n}{dxs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{]}\PY{p}{)}


\PY{n}{nh} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{hs}\PY{p}{)}
\PY{n}{ndx} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{dxs}\PY{p}{)}

\PY{c+c1}{\PYZsh{} define time grid}
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{nt} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{t}\PY{p}{)}

\PY{c+c1}{\PYZsh{} initialize array to hold results}
\PY{n}{f\PYZus{}out} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{nt}\PY{p}{,} \PY{n}{nh}\PY{p}{,} \PY{n}{ndx}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} loop over H values}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{nh}\PY{p}{)}\PY{p}{:}
  \PY{n}{H} \PY{o}{=} \PY{n}{hs}\PY{p}{[}\PY{n}{i}\PY{p}{]}
  \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{ndx}\PY{p}{)}\PY{p}{:}
    \PY{n}{dx} \PY{o}{=} \PY{n}{dxs}\PY{p}{[}\PY{n}{j}\PY{p}{]}
    \PY{n}{f\PYZus{}out}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{n}{fptd\PYZus{}fbm}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{dx}\PY{p}{,} \PY{n}{H}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{105}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{18}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{for} \PY{n}{h} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{hs}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{hval} \PY{o}{=} \PY{n}{hs}\PY{p}{[}\PY{n}{h}\PY{p}{]}
    \PY{n}{i}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{hs}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{n}{hs}\PY{o}{==}\PY{n}{hval}\PY{p}{]}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2} \PY{p}{,}\PY{n}{h}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} set colors}
    \PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{orange}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{green}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} initialize array for peak time}
    \PY{n}{tpeak} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{ndx}\PY{p}{)}\PY{p}{)}
    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{ndx}\PY{p}{)}\PY{p}{:}
        \PY{n}{ipeak} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{n}{f\PYZus{}out}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{n}{j}\PY{p}{]}\PY{p}{)}
        \PY{n}{tpeak}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{n}{t}\PY{p}{[}\PY{n}{ipeak}\PY{p}{]}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{f\PYZus{}out}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{n}{j}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{colors}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}dx=\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{; tp=}\PY{l+s+si}{\PYZpc{}.1f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{dxs}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{,} \PY{n}{tpeak}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{tpeak}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{colors}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}


    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{H=}\PY{l+s+si}{\PYZpc{}.1f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{hs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{f}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{best}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{minorticks\PYZus{}on}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1e\PYZhy{}50}\PY{p}{,} \PY{l+m+mf}{1e5}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}     plt.xlim((1e0,1e2))}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_147_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{95}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} calculate values of c = H*gamma(H+1/2)**2}
\PY{n}{cs} \PY{o}{=} \PY{n}{hs}\PY{o}{*}\PY{n}{gamma}\PY{p}{(}\PY{n}{hs}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
\PY{n}{cs}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{95}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([0.40662925, 0.5       , 0.59012369, 0.70851337])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{179}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{v}\PY{p}{,}\PY{n}{mu}\PY{p}{)}\PY{p}{:}
    \PY{n}{num} \PY{o}{=} \PY{n}{gamma}\PY{p}{(}\PY{n}{mu}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{p}{(}\PY{n}{v}\PY{o}{*}\PY{n}{T}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{jv}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{(}\PY{n}{v}\PY{o}{*}\PY{n}{T}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{denom} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)} \PY{o}{*} \PY{n}{T}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{o}{\PYZhy{}}\PY{n}{mu}\PY{p}{)} \PY{o}{*} \PY{n}{v}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{mu}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)}
    \PY{k}{return} \PY{n}{num}\PY{o}{/}\PY{n}{denom}

\PY{n}{v} \PY{o}{=} \PY{l+m+mf}{0.003}
\PY{n}{mu} \PY{o}{=} \PY{l+m+mf}{1.322}
\PY{n}{err\PYZus{}v} \PY{o}{=} \PY{l+m+mf}{0.001}
\PY{n}{err\PYZus{}mu} \PY{o}{=} \PY{l+m+mf}{0.1}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)} \PY{c+c1}{\PYZsh{} equally log\PYZhy{}spaced grid in time, in units of days (previously, tau)}
\PY{n}{m0} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{v}\PY{p}{,} \PY{n}{mu}\PY{p}{)}
\PY{n}{m1} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{v}\PY{o}{+}\PY{n}{err\PYZus{}v}\PY{p}{,} \PY{n}{mu}\PY{p}{)}
\PY{n}{m2} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{v}\PY{o}{\PYZhy{}}\PY{n}{err\PYZus{}v}\PY{p}{,} \PY{n}{mu}\PY{p}{)}

\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m0}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m2}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Varying v: }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{pm\PYZdl{} }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{v}\PY{p}{,} \PY{n}{err\PYZus{}v}\PY{p}{)}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m0}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m2}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Varying v: }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{pm\PYZdl{} }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{v}\PY{p}{,} \PY{n}{err\PYZus{}v}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{179}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Text(0.5, 1.0, 'Varying v: 0.00300 \$\textbackslash{}\textbackslash{}pm\$ 0.00100')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_149_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{180}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)} \PY{c+c1}{\PYZsh{} equally log\PYZhy{}spaced grid in time, in units of days (previously, tau)}
\PY{n}{m0} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{v}\PY{p}{,} \PY{n}{mu}\PY{p}{)}
\PY{n}{m1} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{v}\PY{p}{,} \PY{n}{mu}\PY{o}{+}\PY{n}{err\PYZus{}mu}\PY{p}{)}
\PY{n}{m2} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{v}\PY{p}{,} \PY{n}{mu}\PY{o}{\PYZhy{}}\PY{n}{err\PYZus{}mu}\PY{p}{)}

\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{dpi} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}facecolor}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m0}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m2}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Varying mu: }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{pm\PYZdl{} }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{n}{err\PYZus{}mu}\PY{p}{)}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m0}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{m2}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Varying mu: }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ \PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{pm\PYZdl{} }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{n}{err\PYZus{}mu}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{180}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Text(0.5, 1.0, 'Varying mu: 1.32200 \$\textbackslash{}\textbackslash{}pm\$ 0.10000')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_150_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Fitting a Log Function}\label{fitting-a-log-function}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{96}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k+kn}{import} \PY{n}{LinearRegression}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k+kn}{import} \PY{n}{FunctionTransformer}

\PY{n}{N} \PY{o}{=} \PY{l+m+mi}{3000}
\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{p}{:}\PY{n}{N}\PY{p}{]}\PY{p}{,} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{p}{:}\PY{n}{N}\PY{p}{]}

\PY{n}{transformer} \PY{o}{=} \PY{n}{FunctionTransformer}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{,} \PY{n}{validate}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{x\PYZus{}trans} \PY{o}{=} \PY{n}{transformer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{p}{)}             \PY{c+c1}{\PYZsh{} 1}
\PY{n}{regressor} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
\PY{n}{results} \PY{o}{=} \PY{n}{regressor}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}trans}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{)}                \PY{c+c1}{\PYZsh{} 2}
\PY{n}{model} \PY{o}{=} \PY{n}{results}\PY{o}{.}\PY{n}{predict}
\PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{model}\PY{p}{(}\PY{n}{x\PYZus{}trans}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{k\PYZhy{}\PYZhy{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Fit}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}             \PY{c+c1}{\PYZsh{} 3}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} plt.xlim(0,1000)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{96}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.legend.Legend at 0x7feb1d7a44f0>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_152_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{97}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{mu}\PY{p}{,}\PY{n}{beta}\PY{p}{,}\PY{p}{)}\PY{p}{:}
  \PY{k}{return} \PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{(}\PY{n}{mu}\PY{p}{)}\PY{o}{*}\PY{p}{(}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{mu}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{beta}\PY{o}{/}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{beta}\PY{o}{*}\PY{o}{*}\PY{n}{mu}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{N} \PY{o}{=} \PY{l+m+mi}{1000}
\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{p}{:}\PY{n}{N}\PY{p}{]}\PY{p}{,} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{p}{:}\PY{n}{N}\PY{p}{]}

\PY{k}{def} \PY{n+nf}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{v}\PY{p}{,}\PY{n}{mu}\PY{p}{,}\PY{n}{Norm}\PY{p}{)}\PY{p}{:}
    \PY{n}{num} \PY{o}{=} \PY{n}{gamma}\PY{p}{(}\PY{n}{mu}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{p}{(}\PY{n}{v}\PY{o}{*}\PY{n}{T}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{jv}\PY{p}{(}\PY{n}{v}\PY{p}{,} \PY{n}{mu}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{denom} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{*} \PY{n}{T}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2}\PY{o}{\PYZhy{}}\PY{n}{mu}\PY{p}{)} \PY{o}{*} \PY{n}{v}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{mu}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{Norm}
    \PY{k}{return} \PY{n}{num}\PY{o}{/}\PY{n}{denom}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mf}{0.001}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mf}{2.47}\PY{p}{,} \PY{n}{Norm} \PY{o}{=} \PY{l+m+mi}{10}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theoretical MSD\PYZhy{}fit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}samp}\PY{p}{,} \PY{n}{y\PYZus{}samp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} plt.xscale(\PYZdq{}log\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.yscale(\PYZdq{}log\PYZdq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} set range of fitting regime}
\PY{n}{tau\PYZus{}fit\PYZus{}min} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{tau\PYZus{}fit\PYZus{}max} \PY{o}{=} \PY{l+m+mf}{1000.}

\PY{c+c1}{\PYZsh{} set initial values for v, mu}
\PY{c+c1}{\PYZsh{} v, mu = 0.07, 1.25}
\PY{n}{initial\PYZus{}ss} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,} \PY{l+m+mf}{2.47}\PY{p}{,} \PY{l+m+mi}{10}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{10}\PY{p}{]}
\PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{)}
\PY{n}{i\PYZus{}fit} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{[}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{tau\PYZus{}fit\PYZus{}min}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp} \PY{o}{\PYZlt{}} \PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{)}\PY{p}{]}
\PY{c+c1}{\PYZsh{} i\PYZus{}fit}
\PY{n}{x\PYZus{}fit} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{n}{i\PYZus{}fit}\PY{p}{]}
\PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{n}{i\PYZus{}fit}\PY{p}{]}
\PY{n}{n\PYZus{}fit} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{i\PYZus{}fit}\PY{p}{)}
\PY{n}{popt}\PY{p}{,} \PY{n}{pcov} \PY{o}{=} \PY{n}{curve\PYZus{}fit}\PY{p}{(}\PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{,} \PY{n}{x\PYZus{}fit}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{n}{initial\PYZus{}ss}\PY{p}{,} \PY{n}{maxfev}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}

\PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu}\PY{p}{,} \PY{n}{fit\PYZus{}Norm} \PY{o}{=} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}
\PY{n}{err\PYZus{}v}\PY{p}{,} \PY{n}{err\PYZus{}mu}\PY{p}{,} \PY{n}{err\PYZus{}Norm} \PY{o}{=} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}\PY{p}{,}  \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}


\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v = }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{), mu = }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{), Norm = }\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.5f}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{err\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu}\PY{p}{,} \PY{n}{err\PYZus{}mu}\PY{p}{,} \PY{n}{fit\PYZus{}Norm}\PY{p}{,} \PY{n}{err\PYZus{}Norm}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} plot the MSD curve w/fit}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}fit}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bo\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{xx} \PY{o}{=} \PY{n}{x\PYZus{}fit}
\PY{n}{yy} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu}\PY{p}{,} \PY{n}{fit\PYZus{}Norm}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{yy}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{best\PYZhy{}fit theoretical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{best}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} plt.xscale(\PYZdq{}log\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.yscale(\PYZdq{}log\PYZdq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{} (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{xx} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}
\PY{n}{yy} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{yy}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{best\PYZhy{}fit theoretical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{v}\PY{p}{,} \PY{n}{mu} \PY{o}{=} \PY{l+m+mf}{0.07}\PY{p}{,} \PY{l+m+mf}{1.25}
\PY{c+c1}{\PYZsh{} v, mu = 0.002, 2.1}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{msd\PYZus{}theo} \PY{o}{=} \PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{,}\PY{n}{v}\PY{p}{,}\PY{n}{mu}\PY{p}{)}
\PY{c+c1}{\PYZsh{} k = np.mean(msd\PYZus{}theo/msd\PYZus{}emp)}
\PY{c+c1}{\PYZsh{} offset = msd\PYZus{}theo/k \PYZhy{} msd\PYZus{}emp}
\PY{c+c1}{\PYZsh{} np.mean(offset)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} k = msd\PYZus{}theo[2] \PYZhy{} msd\PYZus{}emp[2]}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{msd\PYZus{}theo} \PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theoretical MSD\PYZhy{}fit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{,} \PY{n}{msd\PYZus{}emp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{c+c1}{\PYZsh{} plt.ylim(\PYZhy{}10,10)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{msd\PYZus{}emp}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} set range of fitting regime}
\PY{n}{tau\PYZus{}fit\PYZus{}min} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{tau\PYZus{}fit\PYZus{}max} \PY{o}{=} \PY{l+m+mf}{1000.}

\PY{c+c1}{\PYZsh{} set initial values for v, mu}
\PY{c+c1}{\PYZsh{} v, mu = 0.07, 1.25}
\PY{n}{initial\PYZus{}ss} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.002}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{]}
\PY{n}{n\PYZus{}tau} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{)}
\PY{n}{i\PYZus{}fit} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{n\PYZus{}tau}\PY{p}{)}\PY{p}{[}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{tau\PYZus{}fit\PYZus{}min}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp} \PY{o}{\PYZlt{}} \PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{)}\PY{p}{]}
\PY{c+c1}{\PYZsh{} i\PYZus{}fit}
\PY{n}{x\PYZus{}fit} \PY{o}{=} \PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{[}\PY{n}{i\PYZus{}fit}\PY{p}{]}
\PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{msd\PYZus{}emp}\PY{p}{[}\PY{n}{i\PYZus{}fit}\PY{p}{]}
\PY{n}{n\PYZus{}fit} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{i\PYZus{}fit}\PY{p}{)}
\PY{n}{popt}\PY{p}{,} \PY{n}{pcov} \PY{o}{=} \PY{n}{curve\PYZus{}fit}\PY{p}{(}\PY{n}{msd\PYZus{}theo\PYZus{}ss}\PY{p}{,} \PY{n}{x\PYZus{}fit}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{n}{initial\PYZus{}ss}\PY{p}{,} \PY{n}{maxfev}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}

\PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu} \PY{o}{=} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{popt}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{c+c1}{\PYZsh{}, popt[2]}
\PY{n}{err\PYZus{}v}\PY{p}{,} \PY{n}{err\PYZus{}mu} \PY{o}{=} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{pcov}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v = }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{), mu = }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{fit\PYZus{}v}\PY{p}{,} \PY{n}{err\PYZus{}v}\PY{p}{,} \PY{n}{fit\PYZus{}mu}\PY{p}{,} \PY{n}{err\PYZus{}mu}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} plot the MSD curve w/fit}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{delta\PYZus{}vals\PYZus{}emp}\PY{p}{,} \PY{n}{msd\PYZus{}emp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bo\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{empirical MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} xx = delta\PYZus{}vals\PYZus{}emp}
\PY{c+c1}{\PYZsh{} yy = msd\PYZus{}theo\PYZus{}ss(xx, fit\PYZus{}v, fit\PYZus{}mu)}
\PY{c+c1}{\PYZsh{} plt.plot(xx, yy, \PYZsq{}k\PYZhy{}\PYZsq{}, label=\PYZdq{}best\PYZhy{}fit theoretical MSD\PYZdq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{tau\PYZus{}fit\PYZus{}max}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ls}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{best}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} plt.xscale(\PYZdq{}log\PYZdq{})}
\PY{c+c1}{\PYZsh{} plt.yscale(\PYZdq{}log\PYZdq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tau\PYZdl{} (days)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
